### тЬЕ **React ржХрзАржнрж╛ржмрзЗ ржЬрж╛ржирзЗ ржХрзЛржи ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ state ржзрж░рзЗ рж░рж╛ржЦржмрзЗ ржЖрж░ ржХрзЛржиржЯрж╛рж░ рж░рж┐рж╕рзЗржЯ ржХрж░ржмрзЗ?**

**ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛрж░ ржоржзрзНржпрзЗ рж╕рзНржЯрзЗржЯ ржЖрж▓рж╛ржжрж╛ ржерж╛ржХрзЗред**

React-ржПрж░ рж╕рзНржЯрзЗржЯ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯрзЗрж░ ржорзВрж▓ ржмрж┐рж╖рзЯ рж╣рж▓рзЛ, ржкрзНрж░рждрж┐ржЯрж┐ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ ржирж┐ржЬрж╕рзНржм рж╕рзНржЯрзЗржЯ ржерж╛ржХрзЗред ржпржЦржиржЗ ржХрзЛржирзЛ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ ржкрж░рж┐ржмрж░рзНрждржи рж╣рзЯ, рждржЦржи React рж╕рзЗржЗ ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ржХрзЗ ржЖржмрж╛рж░ рж░рзЗржирзНржбрж╛рж░ ржХрж░рзЗред ржХрж┐ржирзНрждрзБ ржХржЦржирзЛ ржХржЦржирзЛ React рж╕рзНржЯрзЗржЯ ржзрж░рзЗ рж░рж╛ржЦрзЗ (preserve) ржПржмржВ ржХржЦржирзЛ рж░рж┐рж╕рзЗржЯ (reset) ржХрж░рзЗред

React UI tree-рждрзЗ ржкрзНрж░рждрж┐ржЯрж┐ ржХржорзНржкрзЛржирзЗржирзНржЯ ржХрзЛржерж╛ржпрж╝ ржЖржЫрзЗ рждрж╛рж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржХрзЛржи рж╕рзНржЯрзЗржЯ ржХрзЛржи ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзЗржЯрж╛ ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рзЗред ржЖржкржирж┐ ржЪрж╛ржЗрж▓рзЗ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, ржХрзЛржи рж╕ржоржпрж╝рзЗ рж╕рзНржЯрзЗржЯ ржзрж░рзЗ рж░рж╛ржЦрж╛ рж╣ржмрзЗ (preserve) ржЖрж░ ржХрзЛржи рж╕ржоржпрж╝рзЗ рж╕рзЗржЯрж╛ рж░рж┐рж╕рзЗржЯ (reset) рж╣ржмрзЗред

**ржЖржкржирж┐ ржпрж╛ рж╢рж┐ржЦржмрзЗржиржГ**

- ржХржЦржи React рж╕рзНржЯрзЗржЯ ржзрж░рзЗ рж░рж╛ржЦрзЗ ржЖрж░ ржХржЦржи рж░рж┐рж╕рзЗржЯ ржХрж░рзЗ
- ржХрзАржнрж╛ржмрзЗ ржЖржкржирж┐ ржЬрзЛрж░ ржХрж░рзЗ ржХрзЛржирзЛ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ рж░рж┐рж╕рзЗржЯ ржХрж░рж╛рждрзЗ ржкрж╛рж░рзЗржи
- ржХрзАржнрж╛ржмрзЗ key ржПржмржВ component ржПрж░ type рж╕рзНржЯрзЗржЯ ржзрж░рзЗ рж░рж╛ржЦрж╛ ржмрж╛ рж░рж┐рж╕рзЗржЯ ржХрж░рж╛рж░ ржЙржкрж░ ржкрзНрж░ржнрж╛ржм ржлрзЗрж▓рзЗ

---

React state ржзрж░рзЗ рж░рж╛ржЦрзЗ рж╕рзЗржЗ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ ржЬржирзНржп ржпрзЗржЯрж┐ ржЖржЧрзЗрж░ рж░рзЗржирзНржбрж╛рж░рзЗржУ ржЫрж┐рж▓ **ржПржХржЗ ржЕржмрж╕рзНржерж╛ржирзЗ (same position in the tree)**ред

ЁЯУН ржорж╛ржирзЗ рж╣рж▓рзЛ: JSX-ржП ржХрзАржнрж╛ржмрзЗ рж▓рж┐ржЦрзЗржЫрзЛ рж╕рзЗржЯрж╛ ржирж╛, ржмрж░ржВ UI Tree-ржПрж░ ржХрж╛ржарж╛ржорзЛрждрзЗ рж╕рзЗржЗ ржХржорзНржкрзЛржирзЗржирзНржЯ ржХрзЛржи тАЬржЕржмрж╕рзНржерж╛ржирзЗтАЭ ржЖржЫрзЗ рж╕рзЗржЯрж╛ React ржжрзЗржЦрзЗред

---

## State is tied to a position in the render tree

### ЁЯФБ **ржпржжрж┐ ржПржХржЗ component ржерж╛ржХрзЗ ржПржХржЗ ржЬрж╛рзЯржЧрж╛рзЯ, рждрж╛рж╣рж▓рзЗ state ржерж╛ржХрзЗ preserved:**

```jsx
{
  isFancy ? <Counter isFancy={true} /> : <Counter isFancy={false} />;
}
```

тЮбя╕П ржЙржкрж░рзЗрж░ ржжрзБржЗржЯрж╛ `<Counter />` ржЖрж▓рж╛ржжрж╛ JSX рж▓рж╛ржЗржи рж╣рж▓рзЗржУ React ржжрзЗржЦрзЗ ржпрзЗ ржПржЯрж╛ ржжрзБржЗ ржХрзНрж╖рзЗрждрзНрж░рзЗржЗ ржПржХржЗ ржкржЬрж┐рж╢ржирзЗ ржЖржЫрзЗред рждрж╛ржЗ state ржорзБржЫрзЗ ржирж╛ ржлрзЗрж▓рзЗ ржзрж░рзЗ рж░рж╛ржЦрзЗред

---

### тЭМ **ржХрж┐ржирзНрждрзБ ржпржжрж┐ ржПржХржЗ ржЬрж╛рзЯржЧрж╛рзЯ ржЖрж▓рж╛ржжрж╛ component ржЖрж╕рзЗ (ржпрзЗржоржи `<Counter />` vs `<p>`) рждрж╛рж╣рж▓рзЗ state ржорзБржЫрзЗ ржпрж╛рзЯ:**

```jsx
{
  isPaused ? <p>See you later!</p> : <Counter />;
}
```

тЮбя╕П ржПржЦрж╛ржирзЗ `<p>` ржЖрж░ `<Counter />` ржПржХрзЗ ржЕржкрж░рзЗрж░ ржмржжрж▓рзЗ ржЖрж╕рзЗред ржжрзБржЗржЯрж╛ ржЖрж▓рж╛ржжрж╛ ржЯрж╛ржЗржкрзЗрж░ componentред рждрж╛ржЗ React ржЖржЧрзЗрж░ржЯрж╛ (Counter) рж╕рж░рж┐рзЯрзЗ ржжрзЗрзЯ ржПржмржВ ржирждрзБржиржЯрж╛ (p) рждрзИрж░рж┐ ржХрж░рзЗред ржлрж▓рзЗ Counter-ржПрж░ state ржорзБржЫрзЗ ржпрж╛рзЯред

---

### ЁЯФБ **ржПржоржиржХрж┐ ржпржжрж┐ wrapper tag-ржУ ржкрж╛рж▓рзНржЯрзЗ ржлрзЗрж▓рзЛ (section vs div), рждрж╛рж╣рж▓рзЗ ржнрзЗрждрж░рзЗрж░ state-ржУ reset рж╣рзЯ:**

```jsx
{
  isFancy ? (
    <div>
      <Counter isFancy={true} />
    </div>
  ) : (
    <section>
      <Counter isFancy={false} />
    </section>
  );
}
```

тЮбя╕П ржПржЦрж╛ржирзЗ `<Counter />` рждрзЛ ржПржХржЗ, ржХрж┐ржирзНрждрзБ ржУрж░ parent tag ржкрж╛рж▓рзНржЯрзЗ ржЧрзЗржЫрзЗ тАФ `div` ржЖрж░ `section`ред рждрж╛ржЗ React ржнрж╛ржмрзЗ ржкрзБрж░рзЛ branch ржкрж╛рж▓рзНржЯрзЗ ржЧрзЗржЫрзЗред ржкрзБрж░ржирзЛржЯрж╛ ржорзБржЫрзЗ ржжрж┐рзЯрзЗ ржирждрзБржиржЯрж╛ рждрзИрж░рж┐ ржХрж░рзЗред ржлрж▓рзЗ state рж░рж┐рж╕рзЗржЯ рж╣рзЯред

---

### тЭЧ **Pitfall: Component ржлрж╛ржВрж╢ржи ржнрзЗрждрж░рзЗ define ржХрж░рж▓рзЗ state ржзрж░рзЗ рж░рж╛ржЦрж╛ ржпрж╛рзЯ ржирж╛:**

```jsx
function MyComponent() {
  function MyTextField() {
    const [text, setText] = useState('');
    ...
  }

  return <MyTextField />;
}
```

тЮбя╕П ржПржЦрж╛ржирзЗ ржкрзНрж░рждрж┐ рж░рзЗржирзНржбрж╛рж░рзЗ `MyTextField` ржирждрзБржи ржХрж░рзЗ рждрзИрж░рж┐ рж╣ржЪрзНржЫрзЗред рждрж╛ржЗ React ржзрж░рзЗ ржирзЗрзЯ ржПржЯрж╛ ржирждрзБржи component тАФ ржкрзБрж░рзЛржирзЛ state ржорзБржЫрзЗ ржпрж╛рзЯред

тЬЕ **рж╕ржорж╛ржзрж╛ржи**: рж╕ржм ржХржорзНржкрзЛржирзЗржирзНржЯ ржлрж╛ржВрж╢ржи ржЧрзБрж▓рзЛ ржЙржкрж░рзЗ declare ржХрж░рзЛ (ржмрж╛ржЗрж░рзЗ)ред

---

### ЁЯФС рж╢рзЗрж╖ ржХржерж╛:

React-ржПрж░ state ржХржЦржи ржзрж░рзЗ рж░рж╛ржЦржмрзЗ, ржЖрж░ ржХржЦржи рж░рж┐рж╕рзЗржЯ ржХрж░ржмрзЗ рждрж╛ ржирж┐рж░рзНржнрж░ ржХрж░рзЗ:

- component ржПрж░ ржЯрж╛ржЗржк ржПржХржЗ ржХрж┐ржирж╛
- UI tree-рждрзЗ рждрж╛рж░ ржЕржмрж╕рзНржерж╛ржи ржПржХржЗ ржХрж┐ржирж╛

ржПржХржЗ ржЯрж╛ржЗржк + ржПржХржЗ ржЕржмрж╕рзНржерж╛ржи = state preserved  
ржнрж┐ржирзНржи ржЯрж╛ржЗржк ржмрж╛ ржнрж┐ржирзНржи ржЕржмрж╕рзНржерж╛ржи = state destroyed

---
