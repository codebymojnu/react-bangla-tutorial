рждрзЛржорж╛рж░ ржкрзНрж░рж╢рзНржиржЯрж╛ ржЦрзБржм ржнрж╛рж▓рзЛ тАФ тАМ\*\*"ржПржХржЗ рж░ржХржорзЗрж░ рж▓ржЬрж┐ржХ, ржХрж┐ржирзНрждрзБ ржЙржкрж░рзЗрж░ ржХрзЛржбржЯрж╛ ржХрж╛ржЬ ржХрж░ржЫрзЗ, ржЖржорж╛рж░ржЯрж╛ ржХрзЗржи ржХрж╛ржЬ ржХрж░ржЫрзЗ ржирж╛?"\*\* тАФ ржПржЯрж╛ ржмрзЛржЭрж╛ ржорж╛ржирзЗ `ref`, `Map` ржЖрж░ `React rendering` ржнрж╛рж▓рзЛржнрж╛ржмрзЗ ржмрзЛржЭрж╛ред

ржЪрж▓рзЛ рж╕ржВржХрзНрж╖рзЗржкрзЗ ржкрж╛рж░рзНржержХрзНржпржЯрж╛ ржмрж╛ржВрж▓рж╛рзЯ ржмрзНржпрж╛ржЦрзНржпрж╛ ржХрж░рж┐:

---

## тЬЕ ржЙржкрж░рзЗрж░ ржХрзЛржбржЯрж╛ (CatFriends) ржХрзЗржи ржХрж╛ржЬ ржХрж░рзЗ?

```js
if (!itemsRef.current) {
  itemsRef.current = new Map(); // ржкрзНрж░ржержоржмрж╛рж░рзЗржЗ ref-ржП Map рж╕рзЗржЯ ржХрж░рзЗ ржжрж┐ржЪрзНржЫрзЗ
}
```

ЁЯФН ржЕрж░рзНржерж╛рзО:

- ржПржХржмрж╛рж░ ржпржЦржи `getMap()` ржХрж▓ рж╣рзЯ, рждржЦржи ржпржжрж┐ `itemsRef.current` ржлрж╛ржБржХрж╛ ржерж╛ржХрзЗ, **рж╕рзЗржЗ рж╕ржорзЯрзЗржЗ рж╕рзЗржЯрж╛ `new Map()` ржжрж┐рзЯрзЗ ржкрзВрж░ржг ржХрж░рзЗ**ред
- ржПрж░ржкрж░ ржерзЗржХрзЗ ржПржХржЗ Map ржмрж╛рж░ржмрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ, ржПржмржВ рж╕рзЗржЯрж╛рждрзЗржЗ DOM node ржЧрзБрж▓рзЛ рж╕рзЗржЯ рж╣рзЯред

ЁЯза ржорж╛ржирзЗ: **ржПржХржЯрж╛ржЗ Map ржмрж╛ржирж╛ржирзЛ рж╣рзЯ ржПржмржВ рж╕рзЗржЯрж╛ ржмрж╛рж░ржмрж╛рж░ рж░рж┐ржлрж╛рж░рзЗржирзНрж╕ рж╣рж┐рж╕рзЗржмрзЗ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ**ред

---

## тЭМ ржХрж┐ржирзНрждрзБ рждрзЛржорж╛рж░ ржХрзЛржбрзЗ ржХрзА рж╣ржЪрзНржЫрзЗ?

```js
function getMap() {
  if (!imageRef.current) {
    return new Map(); // ржирждрзБржи Map ржмрж╛ржирж┐рзЯрзЗ ржлрзЗрж▓рзЛ, ржХрж┐ржирзНрждрзБ рж╕рзЗржЯрж┐ ref-ржП рж░рж╛ржЦрзЛ ржирж╛!
  }
  return imageRef.current;
}
```

ЁЯФН рждрзБржорж┐ `new Map()` рждрзИрж░рж┐ ржХрж░рзЛ ржарж┐ржХржЗ, ржХрж┐ржирзНрждрзБ ржХржЦржирзЛржЗ `imageRef.current = new Map()` ржХрж░рзЛ ржирж╛ред

ржлрж▓рзЗ:

- `ref={(node) => { ... }}` ржПрж░ ржнрж┐рждрж░рзЗрж░ `map.set(...)` тАУ ржПржЗ `map` рж╣ржЪрзНржЫрзЗ ржПржХржмрж╛рж░рзЗрж░ ржЬржирзНржп рждрзИрж░рж┐ рж╣ржУрзЯрж╛ Map, ржкрж░рзЗрж░ ржмрж╛рж░ ржЖржмрж╛рж░ ржлрж╛ржБржХрж╛ ржирждрзБржи Map рж╣рзЯрзЗ ржпрж╛рзЯред
- рж╕рзНржХрзНрж░рж▓ ржХрж░рж╛рж░ рж╕ржорзЯ ржЖржмрж╛рж░ ржирждрзБржи `Map()` ржерзЗржХрзЗ `get(image)` ржХрж░рж▓рзЗ ржХрж┐ржЫрзБржЗ ржкрж╛ржУрзЯрж╛ ржпрж╛ржЪрзНржЫрзЗ ржирж╛ред

---

## тЬЕ рж╕ржорж╛ржзрж╛ржи (рждрзЛржорж╛рж░ ржХрзЛржбрзЗ ржпрзЗржЯрж╛ ржХрж░рждрзЗ рж╣ржмрзЗ):

```js
const imageRef = useRef(null);

function getMap() {
  if (!imageRef.current) {
    imageRef.current = new Map(); // тЖР ржПржЯрзБржХрзБ ржпрзЛржЧ ржХрж░рж▓рзЗржЗ ржарж┐ржХ рж╣рзЯрзЗ ржпрж╛ржмрзЗ
  }
  return imageRef.current;
}
```

---

## ЁЯОп рж╕ржВржХрзНрж╖рзЗржкрзЗ рждрзБрж▓ржирж╛:

| ржмрж┐рж╖рзЯ       | рждрзЛржорж╛рж░ ржХрзЛржб                                  | CatFriends ржХрзЛржб                               |
| ---------- | ------------------------------------------ | -------------------------------------------- |
| `Map` рждрзИрж░рж┐ | `new Map()` рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗ, ржХрж┐ржирзНрждрзБ рж╕рзЗржЯ ржХрж░рзЗ ржирж╛ | `new Map()` рждрзИрж░рж┐ ржХрж░рзЗ `ref.current` ржП рж╕рзЗржЯ ржХрж░рзЗ |
| рж░рзЗржлрж╛рж░рзЗржирзНрж╕  | ржкрзНрж░рждрж┐ржмрж╛рж░ ржирждрзБржи Map                          | ржПржХржмрж╛рж░ рждрзИрж░рж┐, рж╕ржм ржЬрж╛рзЯржЧрж╛рзЯ ржмрзНржпржмрж╣рж╛рж░                |
| ржХрж╛ржЬ ржХрж░рзЗ?   | ржирж╛                                         | рж╣рзНржпрж╛ржБ                                        |

---

рждрзЛржорж╛рж░ ржХрзЛржбрзЗ ржЫрзЛржЯ ржПржХржЯрж╛ рж▓рж╛ржЗржирзЗ `imageRef.current = new Map()` ржмрж╕рж╛рж▓рзЗржЗ, ржкрзБрж░рзЛ ржХрзЛржб ржарж┐ржХржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░ржмрзЗред

рждрзБржорж┐ ржХрж┐ ржЪрж╛ржУ ржЖржорж┐ рждрзЛржорж╛рж░ ржкрзБрж░ржирзЛ ржХрзЛржбржЯрж╛ ржПржЗ ржарж┐ржХржнрж╛ржмрзЗ ржЖржкржбрзЗржЯ ржХрж░рзЗ ржЖржмрж╛рж░ ржжрж┐рзЯрзЗ ржжрж┐ржЗ?
