# ржЖржкржирж╛рж░ рж╣рзЯрждрзЛ useEffect-ржПрж░ ржжрж░ржХрж╛рж░ ржирзЗржЗ

`useEffect` рж╣ржЪрзНржЫрзЗ React-ржПрж░ ржирж┐рзЯржоржХрж╛ржирзБржи (paradigm) ржерзЗржХрзЗ ржмрзЗрж░ рж╣рзЯрзЗ ржмрж╛ржЗрж░рзЗрж░ ржХрзЛржирзЛ рж╕рж┐рж╕рзНржЯрзЗржорзЗрж░ (ржпрзЗржоржи: API, DOM, ржерж╛рж░рзНржб-ржкрж╛рж░рзНржЯрж┐ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐) рж╕рж╛ржерзЗ ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░рж╛рж░ ржжрж░ржЬрж╛ред ржХрж┐ржирзНрждрзБ ржпржжрж┐ React ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ ржнрж┐рждрж░рзЗ ржерж╛ржХрж╛ props ржмрж╛ state ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржнрж┐рждрзНрждрж┐рждрзЗ ржХрж┐ржЫрзБ ржХрж░рж╛рж░ ржжрж░ржХрж╛рж░ рж╣рзЯ, рждрж╛рж╣рж▓рзЗ `useEffect` ржПрж░ ржкрзНрж░тАНрзЯрзЛржЬржи ржирзЗржЗред ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ `useEffect` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржХрзЛржб ржЬржЯрж┐рж▓ рж╣рзЯ, ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ ржХржорзЗ ржпрж╛рзЯ, ржПржмржВ ржмрж╛ржЧ рж╣ржУрзЯрж╛рж░ ржЭрзБржБржХрж┐ ржмрж╛рзЬрзЗред

- ржХржЦржи ржПржмржВ ржХрзЗржи ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ `useEffect` ржмрж╛ржж ржжрж┐рждрзЗ рж╣ржмрзЗ
- ржХрж┐ржнрж╛ржмрзЗ ржЦрж░ржЪрж╕рж╛ржкрзЗржХрзНрж╖ (expensive) ржЧржгржирж╛ Effect ржЫрж╛рзЬрж╛ ржХрзНржпрж╛рж╢ ржХрж░ржмрзЗржи
- ржХрж┐ржнрж╛ржмрзЗ state reset ржмрж╛ ржЖржкржбрзЗржЯ ржХрж░ржмрзЗржи `useEffect` ржЫрж╛рзЬрж╛
- ржХрж┐ржнрж╛ржмрзЗ ржПржХрж╛ржзрж┐ржХ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ рж▓ржЬрж┐ржХ рж╢рзЗрзЯрж╛рж░ ржХрж░ржмрзЗржи
- ржХрзЛржи рж▓ржЬрж┐ржХ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ рж░рж╛ржЦрж╛ ржЙржЪрж┐ржд
- ржХрж┐ржнрж╛ржмрзЗ ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯржХрзЗ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржЦржмрж░ ржжрзЗржмрзЗржи

---

## ржХрж┐ржнрж╛ржмрзЗ ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ useEffect ржмрж╛ржж ржжрж┐ржмрзЗржи {/* how-to-remove-unnecessary-effects */}

React-ржП ржжрзБржЗржЯрж┐ рж╕рж╛ржзрж╛рж░ржг ржХрзНрж╖рзЗрждрзНрж░рзЗ `useEffect` ржирж╛ рж▓рж┐ржЦрзЗржУ ржЖржкржирж╛рж░ ржХрж╛ржЬ рж╣рзЯрзЗ ржпрж╛ржмрзЗ:

---

### тЬЕ ржЖржкржирж┐ ржпржжрж┐ ржбрж╛ржЯрж╛ ржлрж┐рж▓рзНржЯрж╛рж░/ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ ржжрзЗржЦрж╛рждрзЗ ржЪрж╛ржи

**ржнрзБрж▓ ржкржжрзНржзрждрж┐ (ржпрзЗржЦрж╛ржирзЗ ржЕржирзЗржХрзЗ `useEffect` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ):**

```jsx
const [filteredList, setFilteredList] = useState([]);

useEffect(() => {
  setFilteredList(list.filter((item) => item.active));
}, [list]);
```

**ржнрж╛рж▓ ржкржжрзНржзрждрж┐ (Effect ржЫрж╛рзЬрж╛):**

```jsx
const filteredList = list.filter((item) => item.active);
```

ЁЯУМ **ржХрзЗржи?**
React ржпржЦржи рж░рзЗржирзНржбрж╛рж░ ржХрж░рзЗ, рждржЦржи рж╕рзЗ `filteredList` ржЖржмрж╛рж░ рж╣рж┐рж╕рж╛ржм ржХрж░рзЗ ржирзЗрзЯред ржЖрж▓рж╛ржжрж╛ ржХрж░рзЗ `useEffect` ржжрж┐рзЯрзЗ state рж╕рзЗржЯ ржХрж░рж▓рзЗ React ржЕрждрж┐рж░рж┐ржХрзНржд рж░рзЗржирзНржбрж╛рж░ ржХрж░рзЗред рждрж╛ржЗ рж╢рзБржзрзБ ржжрзЗржЦрж╛ржирзЛрж░ ржЬржирзНржп ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж▓рзЗ, рж╕рж░рж╛рж╕рж░рж┐ ржЙржкрж░рзЗрж░ ржорждрзЛ рж▓рж┐ржЦрж▓рзЗржЗ ржпржерзЗрж╖рзНржЯред

---

### тЬЕ ржЖржкржирж┐ ржпржжрж┐ ржЗржЙржЬрж╛рж░рзЗрж░ event рж╣рзНржпрж╛ржирзНржбрж▓ ржХрж░рждрзЗ ржЪрж╛ржи

**ржнрзБрж▓ ржкржжрзНржзрждрж┐ (Effect ржжрж┐рзЯрзЗ event ржзрж░рзЗ):**

```jsx
useEffect(() => {
  if (hasBought) {
    fetch("/api/buy");
    alert("Thanks!");
  }
}, [hasBought]);
```

**ржнрж╛рж▓ ржкржжрзНржзрждрж┐ (ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ рж╕рж░рж╛рж╕рж░рж┐ ржХрж╛ржЬ):**

```jsx
function handleBuyClick() {
  fetch("/api/buy");
  alert("Thanks!");
}
```

ЁЯУМ **ржХрзЗржи?**
ржЗржЙржЬрж╛рж░ ржХржЦржи ржХрж┐ ржХрж░рзЗржЫрзЗ рж╕рзЗржЯрж╛ ржЖржкржирж┐ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗрж░ ржнрж┐рждрж░рзЗ ржЬрж╛ржирзЗржиред ржХрж┐ржирзНрждрзБ `useEffect` рждржЦржи ржЪрж╛рж▓рзБ рж╣рзЯ ржпржЦржи ржХрж╛ржЬ рж╢рзЗрж╖, ржЕржержЪ ржХрзА рж╣рзЯрзЗржЫрзЗ рж╕рзЗржЯрж╛ ржмрзЛржЭрж╛рж░ ржЙржкрж╛рзЯ ржерж╛ржХрзЗ ржирж╛ред рждрж╛ржЗ ржЗржнрзЗржирзНржЯрзЗрж░ ржХрж╛ржЬ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗржЗ ржХрж░рж╛ рж╕ржмржЪрзЗрзЯрзЗ ржнрж╛рж▓рзЛред

---

### ЁЯзк рждрж╛рж╣рж▓рзЗ ржХржЦржи useEffect ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЛ?

ржЖржкржирж┐ ржпржжрж┐ ржмрж╛ржЗрж░рзЗрж░ рж╕рж┐рж╕рзНржЯрзЗржорзЗрж░ рж╕рж╛ржерзЗ React state ржмрж╛ UI рж╕рж┐ржЩрзНржХ ржХрж░рждрзЗ ржЪрж╛ржи, рждржЦржи `useEffect` ржжрж░ржХрж╛рж░ рж╣рзЯред

ржЙржжрж╛рж╣рж░ржг:

```jsx
useEffect(() => {
  const controller = new AbortController();
  fetch("/api/products", { signal: controller.signal })
    .then((res) => res.json())
    .then((data) => setProducts(data));
  return () => controller.abort();
}, []);
```

ЁЯУМ **ржПржЯрж╛ ржжрж░ржХрж╛рж░ рж╣рзЯ ржпржЦржи:**

- API ржерзЗржХрзЗ ржбрзЗржЯрж╛ ржЖржирждрзЗ рж╣рзЯ
- DOM ржорзНржпрж╛ржирж┐ржкрзБрж▓рзЗрж╢ржи ржХрж░рждрзЗ рж╣рзЯ
- WebSocket ржмрж╛ localStorage ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣рзЯ
- ржХрзЛржирзЛ ржерж╛рж░рзНржб-ржкрж╛рж░рзНржЯрж┐ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ React ржПрж░ рж╕рж╛ржерзЗ ржпрзБржХрзНржд ржХрж░рждрзЗ рж╣рзЯ

---

ЁЯФЪ **рж╢рзЗрж╖ ржХржерж╛:**

| ржЖржкржирж┐ ржХрзА ржХрж░рждрзЗ ржЪрж╛ржи?                       | useEffect ржжрж░ржХрж╛рж░? |
| --------------------------------------- | ---------------- |
| ржбрж╛ржЯрж╛ рж╕рж╛ржЬрж╛ржирзЛ (filter/sort/map)           | тЭМ ржирж╛            |
| ржЗржЙржЬрж╛рж░рзЗрж░ ржХрзНрж▓рж┐ржХ/ржЗржиржкрзБржЯ рж╣рзНржпрж╛ржирзНржбрж▓ ржХрж░рж╛        | тЭМ ржирж╛            |
| API ржХрж▓ / DOM ржкрж░рж┐ржмрж░рзНрждржи / External Widget | тЬЕ рж╣рзНржпрж╛ржБ         |

---

ржПржЦржи ржЖржкржирж┐ ржмрзБржЭрзЗ ржпрж╛ржмрзЗржи, рж╕ржм ржХрж┐ржЫрзБрждрзЗржЗ `useEffect` ржжрж░ржХрж╛рж░ рж╣рзЯ ржирж╛ред ржХрзЛржб рж╕рж╣ржЬ ржУ ржкрж╛рж░ржлрж░рзНржорзЗржирзНржЯ рж░рж╛ржЦрждрзЗ рж╣рж▓рзЗ рж╢рзБржзрзБржорж╛рждрзНрж░ ржжрж░ржХрж╛рж░ рж╣рж▓рзЗ `useEffect` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред

ржирж┐ржЪрзЗ ржЖржорж┐ ржЖржкржирж╛рж░ ржжрзЗржУрзЯрж╛ рж╕рзНржЯрж╛ржЗрж▓ ржЕржирзБрж╕рж░ржг ржХрж░рзЗ рж╕рж╣ржЬ ржмрж╛ржВрж▓рж╛рзЯ, ржЯрж┐ржЙржЯрзЛрж░рж┐рзЯрж╛рж▓ ржЖржХрж╛рж░рзЗ ржЕржирзБржмрж╛ржж ржХрж░рзЗ ржжрж┐рж▓рж╛ржо:

---

### props ржмрж╛ state-ржПрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ state ржЖржкржбрзЗржЯ {/* updating-state-based-on-props-or-state */}

ржзрж░рзБржи, ржЖржкржирж╛рж░ ржПржХржЯрж┐ ржХржорзНржкрзЛржирзЗржирзНржЯ ржЖржЫрзЗ ржпрзЗржЦрж╛ржирзЗ ржжрзБржЯрж┐ state рж░рзЯрзЗржЫрзЗ: `firstName` ржПржмржВ `lastName`ред ржЖржкржирж┐ ржПржЗ ржжрзБржЗржЯрж┐ ржорж┐рж▓рж┐рзЯрзЗ `fullName` рждрзИрж░рж┐ ржХрж░рждрзЗ ржЪрж╛ржиред ржЖрж░ ржЪрж╛ржЗржЫрзЗржи, ржпржЦржиржЗ `firstName` ржмрж╛ `lastName` ржмржжрж▓рж╛ржмрзЗ, `fullName` ржирж┐ржЬрзЗ ржерзЗржХрзЗржЗ ржЖржкржбрзЗржЯ рж╣рзЯрзЗ ржпрж╛ржХред

рждржЦржи рж╣рзЯрждрзЛ ржЖржкржирж┐ ржПржЗржнрж╛ржмрзЗ `fullName` ржХрзЗ ржЖрж▓рж╛ржжрж╛ state рж╣рж┐рж╕рзЗржмрзЗ рж░рзЗржЦрзЗ `useEffect` ржжрж┐рзЯрзЗ ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржХржерж╛ ржнрж╛ржмржмрзЗржи:

```js {5-9}
function Form() {
  const [firstName, setFirstName] = useState("Taylor");
  const [lastName, setLastName] = useState("Swift");

  // ЁЯФ┤ ржнрзБрж▓ ржкржжрзНржзрждрж┐: ржмрж╛рзЬрждрж┐ state ржПржмржВ ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ Effect
  const [fullName, setFullName] = useState("");
  useEffect(() => {
    setFullName(firstName + " " + lastName);
  }, [firstName, lastName]);
  // ...
}
```

ржПржЗ ржкржжрзНржзрждрж┐рждрзЗ ржХрж╛ржЬ unnecessary ржЬржЯрж┐рж▓ рж╣рзЯрзЗ ржпрж╛рзЯред ржкрзНрж░ржержорзЗ `fullName` ржкрзБрж░ржирзЛ (stale) ржорж╛ржи ржирж┐рзЯрзЗ рж░рзЗржирзНржбрж╛рж░ рж╣рзЯ, рждрж╛рж░ржкрж░ ржЖржмрж╛рж░ ржирждрзБржи ржорж╛ржи ржжрж┐рзЯрзЗ рж░рзЗржирзНржбрж╛рж░ рж╣рзЯ тАФ ржорж╛ржирзЗ ржПржХрзНрж╕ржЯрзНрж░рж╛ рж░рзЗржирзНржбрж╛рж░рж┐ржВ!

ржПрж░ ржЪрзЗрзЯрзЗ рж╕рж╣ржЬ ржЙржкрж╛рзЯ рж╣рж▓рзЛ: `fullName` ржХрзЗ рж╕рж░рж╛рж╕рж░рж┐ рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржорзЯ рж╣рж┐рж╕рж╛ржм ржХрж░рж╛:

```js {4-5}
function Form() {
  const [firstName, setFirstName] = useState("Taylor");
  const [lastName, setLastName] = useState("Swift");
  // тЬЕ ржнрж╛рж▓рзЛ ржкржжрзНржзрждрж┐: рж╕рж░рж╛рж╕рж░рж┐ рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржорзЯ рж╣рж┐рж╕рж╛ржм ржХрж░рж╛
  const fullName = firstName + " " + lastName;
  // ...
}
```

ЁЯУМ **ржпржЦржи ржХрж┐ржЫрзБ ржЖржкржирж┐ рж╕рж╣ржЬрзЗржЗ props ржмрж╛ state ржерзЗржХрзЗ рж╣рж┐рж╕рж╛ржм ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, рждржЦржи рж╕рзЗржЯрж╛ржХрзЗ state-ржП рж░рж╛ржЦрж╛рж░ ржжрж░ржХрж╛рж░ ржирзЗржЗред** ржмрж░ржВ рж╕рж░рж╛рж╕рж░рж┐ рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржорзЯ рж╣рж┐рж╕рж╛ржм ржХрж░рзЗ ржлрзЗрж▓рзБржиред

ржПрж░ ржлрж▓рзЗ ржЖржкржирж┐ ржкрж╛ржмрзЗржи:

- тЬЕ ржнрж╛рж▓рзЛ ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ (ржХрж╛рж░ржг ржмрж╛рзЬрждрж┐ рж░рзЗржирзНржбрж╛рж░ рж╣ржмрзЗ ржирж╛)
- тЬЕ ржХржо ржХрзЛржб (ржмрж╛рзЬрждрж┐ state ржУ `useEffect` ржмрж╛ржж)
- тЬЕ ржХржо ржмрж╛ржЧ (state ржЧрзБрж▓рзЛрж░ ржоржзрзНржпрзЗ ржнрзБрж▓ржнрж╛ржмрзЗ mismatch рж╣ржУрзЯрж╛рж░ ржЭрзБржБржХрж┐ ржХржо)

ржпржжрж┐ ржПржЗ ржХржирж╕рзЗржкрзНржЯржЯрж╛ ржирждрзБржи рж▓рж╛ржЧрзЗ, рждрж╛рж╣рж▓рзЗ ["Thinking in React"](https://react.dev/learn/thinking-in-react#step-3-find-the-minimal-but-complete-representation-of-ui-state) ржЧрж╛ржЗржбржЯрж┐ ржжрзЗржЦрж▓рзЗ ржкрж░рж┐рж╖рзНржХрж╛рж░ ржзрж╛рж░ржгрж╛ ржкрж╛ржмрзЗржи ржХрзЛржи ржЬрж┐ржирж┐рж╕ржЧрзБрж▓рзЛ state-ржП рж░рж╛ржЦрж╛ ржЙржЪрж┐ржд ржЖрж░ ржХрзЛржиржЧрзБрж▓рзЛ ржирзЯред

---

ржирж┐ржЪрзЗ ржЖржорж┐ рж╕рж╣ржЬ ржнрж╛рж╖рж╛рзЯ, ржЯрж┐ржЙржЯрзЛрж░рж┐рзЯрж╛рж▓ рж╕рзНржЯрж╛ржЗрж▓рзЗ ржмрж╛ржВрж▓рж╛рзЯ ржЕржирзБржмрж╛ржж ржХрж░рж▓рж╛ржо:

---

### ржпржЦржи ржХрзЛржирзЛ prop ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рзЯ, рждржЦржи ржХрж┐ржЫрзБ state ржЕрзНржпрж╛ржбржЬрж╛рж╕рзНржЯ ржХрж░рж╛ {/* adjusting-some-state-when-a-prop-changes */}

ржХржЦржирзЛ ржХржЦржирзЛ ржЖржкржирж┐ ржЪрж╛ржЪрзНржЫрзЗржи ржпрзЗ, ржХрзЛржирзЛ prop ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣рж▓рзЗ state-ржПрж░ ржХрж┐ржЫрзБ ржЕржВрж╢ рж░рж┐рж╕рзЗржЯ ржмрж╛ ржкрж░рж┐ржмрж░рзНрждржи рж╣рзЛржХ тАФ ржХрж┐ржирзНрждрзБ ржкрзБрж░рзЛржЯрж╛ ржирзЯред

ржзрж░рзБржи ржПржЗ `List` ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ `items` ржирж╛ржорзЗрж░ ржПржХржЯрж┐ prop ржирж┐ржЪрзНржЫрзЗ ржПржмржВ `selection` ржирж╛ржорзЗ ржПржХржЯрж┐ state рж░рж╛ржЦржЫрзЗ, ржпрзЗржЯрж╛ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд ржЖржЗржЯрзЗржо ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рзЗред ржЖржкржирж┐ ржЪрж╛ржЗржЫрзЗржи, ржпржЦржиржЗ `items` ржирждрзБржи ржХрзЛржирзЛ ржЕрзНржпрж╛рж░рзЗ ржкрж╛рзЯ, рждржЦржи `selection` ржпрзЗржи `null` рж╣рзЯрзЗ ржпрж╛рзЯред

ржЖржкржирж┐ рж╣рзЯрждрзЛ ржПржоржи ржХрзЛржб рж▓рж┐ржЦрждрзЗ ржкрж╛рж░рзЗржи:

```js {5-8}
function List({ items }) {
  const [isReverse, setIsReverse] = useState(false);
  const [selection, setSelection] = useState(null);

  // ЁЯФ┤ ржнрзБрж▓: prop ржкрж░рж┐ржмрж░рзНрждржирзЗ Effect ржжрж┐рзЯрзЗ state ржЖржкржбрзЗржЯ ржХрж░рж╛
  useEffect(() => {
    setSelection(null);
  }, [items]);
  // ...
}
```

тЭМ ржПржЗ ржкржжрзНржзрждрж┐ржУ ржкрж╛рж░ржлрзЗржХрзНржЯ ржирзЯред ржХрж╛рж░ржг ржПржЦрж╛ржирзЗ ржпрж╛ рж╣ржЪрзНржЫрзЗ:

1. `items` ржмржжрж▓рж╛ржирзЛрж░ ржкрж░ `List` ржПржмржВ ржПрж░ ржЪрж╛ржЗрж▓рзНржб ржХржорзНржкрзЛржирзЗржирзНржЯржЧрзБрж▓рзЛ ржкрзБрж░ржирзЛ `selection` ржжрж┐рзЯрзЗ рж░рзЗржирзНржбрж╛рж░ рж╣рзЯред
2. рждрж╛рж░ржкрж░ React DOM ржЖржкржбрзЗржЯ ржХрж░рзЗ ржПржмржВ `useEffect` ржЪрж╛рж▓рж╛рзЯред
3. ржПрж░ржкрж░ `setSelection(null)` ржжрж┐рзЯрзЗ ржЖржмрж╛рж░ рж░рзЗржирзНржбрж╛рж░ рж╢рзБрж░рзБ рж╣рзЯред

ржЕрж░рзНржерж╛рзО ржПржХрзНрж╕ржЯрзНрж░рж╛ ржПржХ рж░рзЗржирзНржбрж╛рж░рж┐ржВ рж╕рж╛ржЗржХрзЗрж▓ рж╣рзЯрзЗ ржпрж╛рзЯред

тЬЕ ржПржЗ рж╕ржорж╕рзНржпрж╛рж░ ржнрж╛рж▓рзЛ рж╕ржорж╛ржзрж╛ржи рж╣рж▓рзЛ: `useEffect` ржмрж╛ржж ржжрж┐рзЯрзЗ рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржорзЯ рж╕рж░рж╛рж╕рж░рж┐ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рж╛:

```js {5-11}
function List({ items }) {
  const [isReverse, setIsReverse] = useState(false);
  const [selection, setSelection] = useState(null);

  // тЬЕ ржнрж╛рж▓рзЛ: рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржорзЯржЗ ржЪрзЗржХ ржУ ржЖржкржбрзЗржЯ
  const [prevItems, setPrevItems] = useState(items);
  if (items !== prevItems) {
    setPrevItems(items);
    setSelection(null);
  }
  // ...
}
```

ржПржЗржнрж╛ржмрзЗ [ржЖржЧрзЗрж░ рж░рзЗржирзНржбрж╛рж░рзЗрж░ рждржерзНржп рж╕ржВрж░ржХрзНрж╖ржг](https://react.dev/reference/react/useState#storing-information-from-previous-renders) ржХрж░рзЗ рж╕рзНржЯрзЗржЯ ржорзНржпрж╛ржирзЗржЬ ржХрж░рж╛ ржПржХржЯрзБ ржХржарж┐ржи ржоржирзЗ рж╣рждрзЗ ржкрж╛рж░рзЗ, ржХрж┐ржирзНрждрзБ `useEffect` ржжрж┐рзЯрзЗ ржПржХржЗ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржЪрзЗрзЯрзЗ ржПржЯрж╛ ржнрж╛рж▓рзЛред

ржЙржкрж░рзЗрж░ ржХрзЛржбрзЗ, `setSelection(null)` рж╕рж░рж╛рж╕рж░рж┐ рж░рзЗржирзНржбрж╛рж░рзЗрж░ ржнрж┐рждрж░рзЗржЗ рж╣ржЪрзНржЫрзЗред ржПрж░ ржлрж▓рзЗ React ржЕржмрж┐рж▓ржорзНржмрзЗ рж░рзЗржирзНржбрж╛рж░ рж░рж┐ржЬрзЗржХрзНржЯ ржХрж░рзЗ ржЖржмрж╛рж░ ржирждрзБржи ржХрж░рзЗ рж░рзЗржирзНржбрж╛рж░ рж╢рзБрж░рзБ ржХрж░рзЗ тАФ ржХрж┐ржирзНрждрзБ ржПржЦржирзЛ DOM ржЖржкржбрзЗржЯ ржХрж░рзЗржирж┐ ржмрж╛ ржЪрж╛ржЗрж▓рзНржб ржХржорзНржкрзЛржирзЗржирзНржЯ рж░рзЗржирзНржбрж╛рж░ ржХрж░рзЗржирж┐ред ржлрж▓рзЗ ржкрзБрж░ржирзЛ `selection` ржжрж┐рзЯрзЗ DOM-ржП ржХрж┐ржЫрзБ ржжрзЗржЦрж╛ржирзЛрж░ рж╕рзБржпрзЛржЧржЗ ржерж╛ржХрзЗ ржирж╛ред

тЪая╕П ржоржирзЗ рж░рж╛ржЦржмрзЗржи: рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржорзЯ рж╢рзБржзрзБ рж╕рзЗржЗ ржПржХржЗ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред ржЕржирзНржп ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржЧрзЗрж▓рзЗ React ржПрж░рж░ ржжрзЗржЦрж╛ржмрзЗред

ЁЯФБ `items !== prevItems` ржПржЗ ржХржирзНржбрж┐рж╢ржиржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржЬрж░рзБрж░рж┐ тАФ ржирж╛ рж╣рж▓рзЗ ржЗржиржлрж┐ржирж┐ржЯ рж▓рзБржкрзЗ ржкрзЬржмрзЗржиред

тЫФ ржпрзЗржХрзЛржирзЛ DOM ржорзНржпрж╛ржирж┐ржкрзБрж▓рзЗрж╢ржи ржмрж╛ ржЯрж╛ржЗржорж╛рж░ рж╕рзЗржЯ ржХрж░рж╛рж░ ржорждрзЛ ржХрж╛ржЬ рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржорзЯ ржХрж░рж╛ ржпрж╛ржмрзЗ ржирж╛ тАФ рж╕рзЗржЧрзБрж▓рзЛрж░ ржЬрж╛рзЯржЧрж╛ рж╣рж▓рзЛ `useEffect` ржмрж╛ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░ред

---

### тЬЕ рж╕ржмржЪрзЗрзЯрзЗ ржнрж╛рж▓рзЛ рж╕ржорж╛ржзрж╛ржи: рж╕рзНржЯрзЗржЯ ржПржбржЬрж╛рж╕рзНржЯ ржХрж░рж╛рж░ ржжрж░ржХрж╛рж░ржЗ ржирзЗржЗ

**ржпржжрж┐ржУ ржПржЗ ржкрзНржпрж╛ржЯрж╛рж░рзНржи `useEffect`-ржПрж░ ржЪрзЗрзЯрзЗ ржнрж╛рж▓рзЛ, рждрж╛рж░ржкрж░ржУ ржмрзЗрж╢рж┐рж░ржнрж╛ржЧ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржЖржкржирж╛ржХрзЗ ржПржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣ржмрзЗ ржирж╛ред** ржХрж╛рж░ржг props ржмрж╛ state-ржПрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рж╛ ржорж╛ржирзЗ рж╣ржЪрзНржЫрзЗ ржбрзЗржЯрж╛ ржлрзНрж▓рзЛ ржЖрж░ржУ ржЬржЯрж┐рж▓ ржХрж░рж╛, ржпрзЗржЯрж╛ ржбрж┐ржмрж╛ржЧ ржХрж░рж╛ ржХрж╖рзНржЯржХрж░ред

рждрж╛ржЗ ржкрзНрж░ржержорзЗ ржжрзЗржЦрзБржи ржЖржкржирж┐ ржХрж┐ ржкрж╛рж░рждрзЗржи:

- [ржХржорзНржкрзЛржирзЗржирзНржЯржХрзЗ `key` ржжрж┐рзЯрзЗ ржкрзБрж░рзЛ рж░рж┐рж╕рзЗржЯ ржХрж░рждрзЗ](#resetting-all-state-when-a-prop-changes), ржмрж╛
- [рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржорзЯржЗ рж╕ржм рж╣рж┐рж╕рж╛ржм ржХрж░рждрзЗ](#updating-state-based-on-props-or-state)?

ржЙржжрж╛рж╣рж░ржг:

`selection` рж╕рзНржЯрзЗржЯ рж░рзЗржЦрзЗ ржПржмржВ ржмрж╛рж░ржмрж╛рж░ рж░рж┐рж╕рзЗржЯ ржирж╛ ржХрж░рзЗ, ржмрж░ржВ `selectedId` рж░рзЗржЦрзЗ рж╕рж░рж╛рж╕рж░рж┐ рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржорзЯ `selection` рж╣рж┐рж╕рж╛ржм ржХрж░рж╛ ржпрж╛рзЯ:

```js {3-5}
function List({ items }) {
  const [isReverse, setIsReverse] = useState(false);
  const [selectedId, setSelectedId] = useState(null);
  // тЬЕ рж╢рзНрж░рзЗрж╖рзНржа ржкржжрзНржзрждрж┐: рж░рзЗржирзНржбрж╛рж░рзЗрж░ рж╕ржорзЯ рж╣рж┐рж╕рж╛ржм
  const selection = items.find((item) => item.id === selectedId) ?? null;
  // ...
}
```

ржПржЦржи ржЖрж░ state "reset" ржХрж░рж╛рж░ ржжрж░ржХрж╛рж░ ржирзЗржЗред ржпржжрж┐ `selectedId`-рж░ рж╕рж╛ржерзЗ ржорж┐рж▓ ржерж╛ржХрж╛ ржЖржЗржЯрзЗржо `items`-ржПрж░ ржоржзрзНржпрзЗ ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ рж╕рзЗржЯрж╛ ржерж╛ржХржмрзЗ ржирж┐рж░рзНржмрж╛ржЪрж┐рждред ржЖрж░ ржирж╛ ржерж╛ржХрж▓рзЗ, `selection` рж╣ржмрзЗ `null`ред

ЁЯОп ржПржЗ ржкржжрзНржзрждрж┐рждрзЗ `selection` рж╕рзНржмрж╛ржнрж╛ржмрж┐ржХржнрж╛ржмрзЗ ржЖржкржбрзЗржЯ рж╣рзЯ, ржПржмржВ ржЖржкржирж┐ ржмрж╛рзЬрждрж┐ ржЗржлрзЗржХрзНржЯ ржмрж╛ рж╕рзНржЯрзЗржЯ ржПржбржЬрж╛рж╕рзНржЯ ржХрж░рж╛рж░ ржЭрж╛ржорзЗрж▓рж╛ ржерзЗржХрзЗ ржмрзЗржБржЪрзЗ ржпрж╛ржиред

ржирж┐ржЪрзЗ ржЖржкржирж╛рж░ React ржЯрж┐ржЙржЯрзЛрж░рж┐рзЯрж╛рж▓ PDF-ржПрж░ ржЬржирзНржп рж╕рж╣ржЬ ржУ рж╕рзНржкрж╖рзНржЯ ржмрж╛ржВрж▓рж╛рзЯ ржЕржирзБржмрж╛ржж ржжрж┐рж▓рж╛ржо:

---

### POST рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛ржирзЛ {/* sending-a-post-request */}

ржПржЗ `Form` ржХржорзНржкрзЛржирзЗржирзНржЯ ржжрзБржЗ ржзрж░ржирзЗрж░ POST рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛рзЯред
ржХржорзНржкрзЛржирзЗржирзНржЯ ржпржЦржи ржЪрж╛рж▓рзБ рж╣рзЯ рждржЦржи ржПржЯрж╛ ржПржХржЯрж┐ ржЕрзНржпрж╛ржирж╛рж▓рж╛ржЗржЯрж┐ржХрзНрж╕ ржЗржнрзЗржирзНржЯ ржкрж╛ржарж╛рзЯред ржЖрж░ ржпржЦржи ржЖржкржирж┐ ржлрж░рзНржо ржкрзВрж░ржг ржХрж░рзЗ Submit ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░ржмрзЗржи, рждржЦржи ржПржЯрж╛ `/api/register` ржП POST рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛ржмрзЗ:

```js
function Form() {
  const [firstName, setFirstName] = useState("");
  const [lastName, setLastName] = useState("");

  // тЬЕ рж╕ржарж┐ржХ: ржПржЗ ржХрзЛржбржЯрж╛ ржЪрж▓ржмрзЗ ржХрж╛рж░ржг ржХржорзНржкрзЛржирзЗржирзНржЯ ржжрзЗржЦрж╛ржирзЛ рж╣рзЯрзЗржЫрзЗ
  useEffect(() => {
    post("/analytics/event", { eventName: "visit_form" });
  }, []);

  // ЁЯФ┤ ржнрзБрж▓: ржЗржнрзЗржирзНржЯ-ржирж┐рж░рзНржнрж░ рж▓ржЬрж┐ржХ useEffect ржП рж░рж╛ржЦрж╛ ржарж┐ржХ ржирж╛
  const [jsonToSubmit, setJsonToSubmit] = useState(null);
  useEffect(() => {
    if (jsonToSubmit !== null) {
      post("/api/register", jsonToSubmit);
    }
  }, [jsonToSubmit]);

  function handleSubmit(e) {
    e.preventDefault();
    setJsonToSubmit({ firstName, lastName });
  }
}
```

ржЖржЧрзЗрж░ ржЙржжрж╛рж╣рж░ржгрзЗрж░ ржорждрзЛржЗ ржПржЦрж╛ржирзЗ ржЪрж┐ржирзНрждрж╛ ржХрж░рзБржи:

ржЕрзНржпрж╛ржирж╛рж▓рж╛ржЗржЯрж┐ржХрзНрж╕ POST рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯржЯрж┐ `useEffect`-ржП ржерж╛ржХрж╛ ржЙржЪрж┐рждред ржХрж╛рж░ржг ржПржЗ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯржЯрж┐ ржкрж╛ржарж╛ржирзЛрж░ ржХрж╛рж░ржг рж╣рж▓рзЛ ржлрж░рзНржоржЯрж┐ ржЗржЙржЬрж╛рж░рзЗрж░ ржХрж╛ржЫрзЗ ржжрзЗржЦрж╛ржирзЛ рж╣рзЯрзЗржЫрзЗред
(ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯрзЗ ржПржЯрж╛ ржжрзБржЗржмрж╛рж░ ржЪрж╛рж▓рзБ рж╣рждрзЗ ржкрж╛рж░рзЗ, рж╕рзЗржЯрж╛ ржирж┐рзЯрзЗ [ржПржЦрж╛ржирзЗ](https://react.dev/learn/synchronizing-with-effects#sending-analytics) ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржЖржЫрзЗред)

ржХрж┐ржирзНрждрзБ `/api/register` POST рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯржЯрж┐ ржлрж░рзНржо ржжрзЗржЦрж╛ржирзЛрж░ ржХрж╛рж░ржгрзЗ ржирзЯред
ржПржЯрж╛ ржХрзЗржмрж▓ рждржЦржиржЗ ржкрж╛ржарж╛рждрзЗ рж╣ржмрзЗ ржпржЦржи ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА Submit ржмрж╛ржЯржи ржЪрж╛ржкржмрзЗред ржЕрж░рзНржерж╛рзО, ржПржЯрж╛ **рж╢рзБржзрзБржорж╛рждрзНрж░ ржУржЗ рж╕рзНржкрзЗрж╕рж┐ржлрж┐ржХ ржЗржирзНржЯрж╛рж░ржЕрзНржпрж╛ржХрж╢ржирзЗрж░ рж╕ржорзЯ** ржШржЯржмрзЗред

рждрж╛ржЗ ржжрзНржмрж┐рждрзАрзЯ `useEffect` ржорзБржЫрзЗ ржлрзЗрж▓рзБржи ржПржмржВ POST рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯржЯрж┐ рж╕рж░рж╛рж╕рж░рж┐ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ ржирж┐рзЯрзЗ ржпрж╛ржи:

```js
function Form() {
  const [firstName, setFirstName] = useState("");
  const [lastName, setLastName] = useState("");

  // тЬЕ рж╕ржарж┐ржХ: ржПржЗ ржХрзЛржб ржХржорзНржкрзЛржирзЗржирзНржЯ ржжрзЗржЦрж╛ржирзЛрж░ ржЬржирзНржп ржЪрж▓ржЫрзЗ
  useEffect(() => {
    post("/analytics/event", { eventName: "visit_form" });
  }, []);

  function handleSubmit(e) {
    e.preventDefault();
    // тЬЕ рж╕ржарж┐ржХ: ржЗржнрзЗржирзНржЯ-ржирж┐рж░рзНржнрж░ рж▓ржЬрж┐ржХ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ ржЖржЫрзЗ
    post("/api/register", { firstName, lastName });
  }
}
```

ржХрзЛржирзЛ рж▓ржЬрж┐ржХ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ рж░рж╛ржЦржмрзЗржи ржирж╛ржХрж┐ `useEffect`-ржП тАФ
рж╕рзЗржЯрж╛ ржарж┐ржХ ржХрж░рж╛рж░ ржЬржирзНржп ржорзВрж▓ ржкрзНрж░рж╢рзНржи рж╣рж▓рзЛ:
**ржПржЗ ржХрзЛржбржЯрж╛ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржжрзГрж╖рзНржЯрж┐ржХрзЛржг ржерзЗржХрзЗ ржХрзА ржХрж╛рж░ржгрзЗ ржЪрж╛рж▓рж╛ржирзЛ ржжрж░ржХрж╛рж░?**

ржпржжрж┐ ржХрзЛржбржЯрж╛ ржХрзЛржирзЛ ржмрж┐рж╢рзЗрж╖ ржЗржирзНржЯрж╛рж░ржЕрзНржпрж╛ржХрж╢ржирзЗрж░ ржЬржирзНржп рж╣рзЯ, рждрж╛рж╣рж▓рзЗ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ рж░рж╛ржЦрзБржиред
ржЖрж░ ржпржжрж┐ ржХрзЛржбржЯрж╛ ржЪрж╛рж▓рж╛рждрзЗ рж╣рзЯ ржХрж╛рж░ржг ржЗржЙржЬрж╛рж░ ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж┐ рж╕рзНржХрзНрж░рж┐ржирзЗ ржжрзЗржЦрзЗржЫрзЗ, рждрж╛рж╣рж▓рзЗ `useEffect`-ржП рж░рж╛ржЦрзБржиред

ржЕржмрж╢рзНржпржЗ! ржЖрж░ржУ рж╕рж╣ржЬ ржУ рж╕рж░рж▓ ржнрж╛рж╖рж╛рзЯ ржмрзЛржЭрж╛ржЗ:

---

### Chains of computations (ржЧржгржирж╛рж░ ржзрж╛рж░рж╛)

React ржП ржХржЦржирзЛ ржХржЦржирзЛ ржЖржкржирж┐ ржПржоржи ржХрзЛржб рж▓рж┐ржЦрждрзЗ ржкрж╛рж░рзЗржи ржпрзЗржЦрж╛ржирзЗ ржПржХржЯрж╛рж░ ржкрж░ ржПржХржЯрж╛ `useEffect` ржерж╛ржХрзЗ, ржЖрж░ ржкрзНрж░рждрзНржпрзЗржХржЯрж╛ ржЖржЧрзЗрж░ рж╕рзНржЯрзЗржЯ ржжрзЗржЦрзЗ ржирж┐ржЬрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рзЗред ржПржЯрж╛ ржПржХржЯрж╛ ржзрж╛рж░рж╛ ржмрж╛ тАЬchainтАЭ рж╣рзЯрзЗ ржпрж╛рзЯред

ржЙржжрж╛рж╣рж░ржг:

- ржкрзНрж░ржержорзЗ `card` ржмржжрж▓рзЗред
- рждрж╛рж░ржкрж░ `goldCardCount` ржмрж╛рзЬрзЗред
- рждрж╛рж░ржкрж░ `round` ржмрж╛рзЬрзЗред
- рждрж╛рж░ржкрж░ `isGameOver` рж╣рзЯред

ржПржЧрзБрж▓рзЛ ржПржХрзЗ ржПржХрзЗ `useEffect` ржЪрж╛рж▓рж┐рзЯрзЗ ржПржХрзЗ ржЕржирзНржпржХрзЗ ржЯрзНрж░рж┐ржЧрж╛рж░ ржХрж░рзЗред

### рж╕ржорж╕рзНржпрж╛ ржХрзА?

1. **ржзрзАрж░ржЧрждрж┐рж░ ржХрж╛рж░ржг:**
   ржкрзНрж░рждрж┐ржЯрж╛ `setState` ржХрж░рж╛рж░ ржкрж░ React ржЖржмрж╛рж░ ржкрзБрж░рзЛ ржХржорзНржкрзЛржирзЗржирзНржЯ ржУ рждрж╛рж░ рж╕ржирзНрждрж╛ржиржжрзЗрж░ рж░рж┐-рж░рзЗржирзНржбрж╛рж░ ржХрж░рзЗред
   ржзрж░рзБржи:

   - `setCard` тЖТ рж░рзЗржирзНржбрж╛рж░
   - `setGoldCardCount` тЖТ рж░рзЗржирзНржбрж╛рж░
   - `setRound` тЖТ рж░рзЗржирзНржбрж╛рж░
   - `setIsGameOver` тЖТ рж░рзЗржирзНржбрж╛рж░

   ржПржЗ рж░рзЗржирзНржбрж╛рж░ржЧрзБрж▓рзЛ ржЕржирзЗржХ рж╕ржорзЯ ржУ рж╢ржХрзНрждрж┐ ржирж╖рзНржЯ ржХрж░рзЗред

2. **ржХрзЛржб ржЬржЯрж┐рж▓ ржУ ржнржЩрзНржЧрзБрж░ рж╣рзЯ:**
   ржпржжрж┐ ржнржмрж┐рж╖рзНржпрждрзЗ ржЖржкржирж┐ ржЧрзЗржорзЗрж░ ржЖржЧрзЗрж░ ржЦрзЗрж▓рж╛рж░ ржЕржмрж╕рзНржерж╛ ржжрзЗржЦрж╛ржирзЛрж░ ржорждрзЛ ржлрж┐ржЪрж╛рж░ ржХрж░рзЗржи, рждрж╛рж╣рж▓рзЗ ржкрзБрж░рж╛ржирзЛ ржорж╛ржи ржжрж┐рзЯрзЗ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░рж▓рзЗ ржЖржмрж╛рж░ ржР `useEffect` ржЧрзБрж▓рзЛ ржЪрж╛рж▓рзБ рж╣рзЯрзЗ ржнрзБрж▓ ржбрзЗржЯрж╛ ржжрзЗржЦрж╛ржмрзЗред
   ржорж╛ржирзЗ ржПржЗ ржзрж░ржирзЗрж░ ржХрзЛржб рж╕рж╣ржЬрзЗ ржмржжрж▓рж╛ржирзЛ ржпрж╛рзЯ ржирж╛, ржЦрж╛рж░рж╛ржк ржХрж╛ржЬ ржХрж░рзЗред

---

### ржХрзА ржХрж░рж▓рзЗ ржнрж╛рж▓рзЛ?

- рж░рж╛ржирзНржирж╛рж░ рж╕ржорзЯ (render) ржпрждржЯрзБржХрзБ рж╣рж┐рж╕рж╛ржм ржХрж░рж╛ ржпрж╛рзЯ, ржХрж░рзЗ рж░рж╛ржЦрзБржиред
- рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ рж╕ржм ржПржХ ржЬрж╛рзЯржЧрж╛рзЯ, ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ (ржпржЦржи ржЗржЙржЬрж╛рж░ ржХрж╛ржЬ ржХрж░рзЗ) ржХрж░рзБржиред

ржЙржжрж╛рж╣рж░ржг:

```js
function Game() {
  const [card, setCard] = useState(null);
  const [goldCardCount, setGoldCardCount] = useState(0);
  const [round, setRound] = useState(1);

  // рж░рж╛ржирзНржирж╛рж░ рж╕ржорзЯ рж╣рж┐рж╕рж╛ржм ржХрж░рзБржи
  const isGameOver = round > 5;

  function handlePlaceCard(nextCard) {
    if (isGameOver) {
      throw Error("Game already ended.");
    }

    // рж╕ржм рж╣рж┐рж╕рж╛ржм ржПржЦрж╛ржирзЗ ржПржХржмрж╛рж░рзЗ ржХрж░рзБржи
    setCard(nextCard);
    if (nextCard.gold) {
      if (goldCardCount <= 3) {
        setGoldCardCount(goldCardCount + 1);
      } else {
        setGoldCardCount(0);
        setRound(round + 1);
        if (round === 5) {
          alert("Good game!");
        }
      }
    }
  }
}
```

ржПржнрж╛ржмрзЗ ржХрзЛржб ржжрзНрж░рзБржд ржЪрж▓рзЗ, ржХржо рж░рж┐-рж░рзЗржирзНржбрж╛рж░ рж╣рзЯ, ржПржмржВ ржкрж░ржмрж░рзНрждрзА ржЖржкржбрзЗржЯ рж╕рж╣ржЬ рж╣рзЯред

---

### ржЫрзЛржЯрзНржЯ ржХрж┐ржирзНрждрзБ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржХржерж╛:

- ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗрж░ ржоржзрзНржпрзЗ `state` ржЖрж╕рж▓рзЗ ржкрзБрж░рж╛ржирзЛ ржорж╛ржирзЗрж░ ржПржХржЯрж┐ **snapshot**ред
- `setRound(round + 1)` ржХрж▓ ржХрж░рж╛рж░ ржкрж░ржУ `round` ржПржХржЗ ржерж╛ржХрзЗ ржпрждржХрзНрж╖ржг рж░рж┐-рж░рзЗржирзНржбрж╛рж░ рж╣рзЯ ржирж╛ред
- ржирждрзБржи ржорж╛ржи ржжрж░ржХрж╛рж░ рж╣рж▓рзЗ ржирж┐ржЬрзЗ ржПржХржЯрж╛ ржирждрзБржи ржнрзЗрж░рж┐рзЯрзЗржмрж▓ ржмрж╛ржирж╛рждрзЗ рж╣ржмрзЗ, ржпрзЗржоржи:

  ```js
  const nextRound = round + 1;
  ```

---

### ржХржЦржиржУ ржХржЦржиржУ ржЪрзЗржЗржи ржХрж░рж╛ ржарж┐ржХ ржерж╛ржХрзЗ:

ржпрзЗржоржи, ржлрж░рзНржорзЗ ржЕржирзЗржХ ржбрзНрж░ржкржбрж╛ржЙржи ржЖржЫрзЗ ржпрзЗржЦрж╛ржирзЗ ржкрж░рзЗрж░ ржбрзНрж░ржкржбрж╛ржЙржирзЗрж░ ржЕржкрж╢ржи ржЖржЧрзЗрж░ ржбрзНрж░ржкржбрж╛ржЙржирзЗрж░ рж╕рж┐рж▓рзЗржХрж╢ржирзЗрж░ ржЙржкрж░ ржирж┐рж░рзНржнрж░ ржХрж░рзЗред
ржПржХрзНрж╖рзЗрждрзНрж░рзЗ ржирзЗржЯржУрзЯрж╛рж░рзНржХ ржерзЗржХрзЗ ржбрзЗржЯрж╛ ржЖржирждрзЗ рж╣рж▓рзЗ `useEffect` ржжрж┐рзЯрзЗ ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ рж╣рзЯред

---

**рж╕рж╛рж░ржорж░рзНржо:**

> ржПржХрзЗрж░ ржкрж░ ржПржХ `useEffect` ржжрж┐рзЯрзЗ рж╕рзНржЯрзЗржЯ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж▓рзЗ ржХрзЛржб ржзрзАрж░ ржУ ржЬржЯрж┐рж▓ рж╣рзЯред
> рж╕рзНржЯрзЗржЯ ржкрж░рж┐ржмрж░рзНрждржи рж╕ржорзНржнржм рж╣рж▓рзЗ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ ржПржХржмрж╛рж░рзЗржЗ рж╕ржм ржХрж░рзБржиред
> ржПрждрзЗ ржХрзЛржб ржжрзНрж░рзБржд ржУ рж╕рж╣ржЬ рж╣рзЯред

---

ржирж┐рж╢рзНржЪрж┐рждржнрж╛ржмрзЗржЗ! ржирж┐ржЪрзЗ ржЖржорж┐ рж╕рж░рж▓ ржнрж╛рж╖рж╛рзЯ, рж╕рж╣ржЬ рж╢ржмрзНржжрзЗ ржмрзНржпрж╛ржЦрзНржпрж╛ ржХрж░рзЗржЫрж┐ тАФ ржпрзЗржи React рж╢рзЗржЦрж╛ ржирждрзБржиржжрзЗрж░ ржЬржирзНржпржУ ржмрзБржЭрждрзЗ рж╕рзБржмрж┐ржзрж╛ рж╣рзЯред ржкрзНрж░рждрж┐ржЯрж┐ ржкрзЯрзЗржирзНржЯрзЗрж░ рж╕рж╛ржерзЗ **рж╕ржорзНржкрзВрж░рзНржг ржХрзЛржбрж╕рж╣ ржЙржжрж╛рж╣рж░ржг** ржжрж┐рзЯрзЗржЫрж┐, ржпрж╛рждрзЗ ржкрж╛ржаржХ ржмрзБржЭрждрзЗ ржкрж╛рж░рзЗржи ржХрзА рж╣ржЪрзНржЫрзЗ ржПржмржВ ржХрзЗржи рж╣ржЪрзНржЫрзЗред

---

## ЁЯФ░ ржЕрзНржпрж╛ржк рж╢рзБрж░рзБ рж╣ржУрзЯрж╛рж░ рж╕ржорзЯ (Initialization) ржпрж╛ ржПржХржмрж╛рж░ржЗ ржЪрж╛рж▓рж╛ржирзЛ ржЙржЪрж┐ржд {/* initializing-the-application */}

ржЕржирзЗржХ рж╕ржорзЯ ржЖржорж╛ржжрзЗрж░ ржХрж┐ржЫрзБ ржХрж╛ржЬ ржЕрзНржпрж╛ржк рж▓рзЛржб рж╣ржУрзЯрж╛рж░ рж╕ржорзЯ **рж╢рзБржзрзБ ржПржХржмрж╛рж░ржЗ** ржЪрж╛рж▓рж╛ржирзЛ ржжрж░ржХрж╛рж░ рж╣рзЯред ржпрзЗржоржи:

- LocalStorage ржерзЗржХрзЗ ржбрзЗржЯрж╛ рж▓рзЛржб ржХрж░рж╛
- ржЗржЙржЬрж╛рж░рзЗрж░ рж▓ржЧржЗржи ржЯрзЛржХрзЗржи ржЪрзЗржХ ржХрж░рж╛

рждрзБржорж┐ рж╣рзЯрждрзЛ ржнрж╛ржмрждрзЗ ржкрж╛рж░рзЛ, ржПржЗ ржХрж╛ржЬржЧрзБрж▓рзЛ `useEffect` ржжрж┐рзЯрзЗ ржХрж░рж╛ ржпрж╛рзЯ, ржпрзЗржоржи:

```js
import { useEffect } from "react";

function App() {
  // тЪая╕П ржнрзБрж▓ ржкржжрзНржзрждрж┐: ржПржЯрж╛ ржжрзБржЗржмрж╛рж░ ржЪрж▓рждрзЗ ржкрж╛рж░рзЗ ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯрзЗ
  useEffect(() => {
    loadDataFromLocalStorage();
    checkAuthToken();
  }, []);

  return <h1>Hello App</h1>;
}

function loadDataFromLocalStorage() {
  console.log("ЁЯУж LocalStorage ржерзЗржХрзЗ ржбрзЗржЯрж╛ рж▓рзЛржб рж╣рж▓рзЛ");
}

function checkAuthToken() {
  console.log("ЁЯФР ржЯрзЛржХрзЗржи ржЪрзЗржХ ржХрж░рж╛ рж╣рж▓рзЛ");
}
```

### тЪая╕П рж╕ржорж╕рзНржпрж╛ржЯрж╛ ржХрзА?

React ржПрж░ Strict Mode (ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯ ржорзЛржбрзЗ) `useEffect()` **ржжрзБржЗржмрж╛рж░ ржХрж▓ ржХрж░рзЗ** ржпрзЗржи рждрзБржорж┐ ржмрзБржЭрждрзЗ ржкрж╛рж░рзЛ рждрзЛржорж╛рж░ ржХрзЛржб тАЬржмрж╛рж░ржмрж╛рж░ ржЪрж▓рзЗ ржЧрзЗрж▓рзЗтАЭ ржарж┐ржХржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░ржмрзЗ ржХрж┐ржирж╛ред

рждрж╛ржЗ, ржЙржкрж░рзЗрж░ ржХрзЛржбрзЗ `checkAuthToken()` ржПржмржВ `loadDataFromLocalStorage()` **ржжрзБржЗржмрж╛рж░** ржЪрж▓ржмрзЗред ржПрждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣рждрзЗ ржкрж╛рж░рзЗ, ржпрзЗржоржи:

- ржЯрзЛржХрзЗржи ржПржХрзНрж╕ржкрж╛рзЯрж╛рж░ рж╣рзЯрзЗ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ
- ржбрзЗржЯрж╛ ржнрзБрж▓ рж╣рзЯрзЗ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ

---

## тЬЕ рж╕ржорж╛ржзрж╛ржи рзз: ржнрзНржпрж╛рж░рж┐рзЯрзЗржмрж▓ ржжрж┐рзЯрзЗ ржХржирзНржЯрзНрж░рзЛрж▓ ржХрж░рж╛

ржЖржорж░рж╛ ржЪрж╛ржЗ ржПржЗ ржХрзЛржб **ржкрзБрж░рзЛ ржЕрзНржпрж╛ржк ржЪрж╛рж▓рзБ рж╣рж▓рзЗ ржПржХржмрж╛рж░ржЗ ржЪрж▓рзБржХ**, ржмрж╛рж░ржмрж╛рж░ ржирж╛ред ржПржЬржирзНржп ржПржХржЯрж╛ ржЯржк-рж▓рзЗржнрзЗрж▓ ржнрзНржпрж╛рж░рж┐рзЯрзЗржмрж▓ ржжрж┐рзЯрзЗ ржХржирзНржЯрзНрж░рзЛрж▓ ржХрж░рж╛ ржпрж╛рзЯ:

```js
import { useEffect } from "react";

// ржПржЗ ржнрзНржпрж╛рж░рж┐рзЯрзЗржмрж▓ржЯрж╛ ржЯржк-рж▓рзЗржнрзЗрж▓рзЗ ржерж╛ржХржмрзЗ
let didInit = false;

function App() {
  useEffect(() => {
    if (!didInit) {
      didInit = true; // ржПржХржмрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛрж░ ржкрж░ true ржХрж░рзЗ ржжрж┐ржЪрзНржЫрж┐
      loadDataFromLocalStorage();
      checkAuthToken();
    }
  }, []);

  return <h1>тЬЕ рж╕ржарж┐ржХржнрж╛ржмрзЗ ржПржХржмрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ рж╣рзЯрзЗржЫрзЗ</h1>;
}

function loadDataFromLocalStorage() {
  console.log("ЁЯУж LocalStorage ржерзЗржХрзЗ ржбрзЗржЯрж╛ рж▓рзЛржб рж╣рж▓рзЛ");
}

function checkAuthToken() {
  console.log("ЁЯФР ржЯрзЛржХрзЗржи ржЪрзЗржХ ржХрж░рж╛ рж╣рж▓рзЛ");
}
```

### тЫСя╕П ржПржЯрж╛ ржХрж┐ржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

- `didInit` ржирж╛ржорзЗ ржПржХржЯрж╛ ржнрзНржпрж╛рж░рж┐рзЯрзЗржмрж▓ ржмрж╛ржЗрж░рзЗ declare ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред
- ржпржЦржи `App` ржЪрж▓рзЗ, рждржЦржи `useEffect` ржПрж░ ржнрзЗрждрж░ ржЪрзЗржХ ржХрж░рж╛ рж╣рзЯ тАФ `didInit` ржпржжрж┐ false рж╣рзЯ, рждрж╛рж╣рж▓рзЗ ржХрзЛржб ржЪрж▓ржмрзЗред
- ржПржХржмрж╛рж░ ржЪрж▓рж╛рж░ ржкрж░ `didInit = true` ржХрж░рзЗ ржжрзЗрзЯрж╛ рж╣рзЯ, рждрж╛ржЗ ржЖрж░ ржжрзНржмрж┐рждрзАрзЯржмрж╛рж░ ржЪрж▓рзЗ ржирж╛ред

---

## тЬЕ рж╕ржорж╛ржзрж╛ржи рзи: рж░рзЗржирзНржбрж╛рж░ рж╣ржУрзЯрж╛рж░ ржЖржЧрзЗржЗ ржЪрж╛рж▓рж╛ржирзЛ (module initialization)

рждрзБржорж┐ ржЪрж╛ржЗрж▓рзЗ `App` ржХржорзНржкрзЛржирзЗржирзНржЯ рж░рзЗржирзНржбрж╛рж░ рж╣ржУрзЯрж╛рж░ ржЖржЧрзЗржЗ тАФ ржЕрж░рзНржерж╛рзО ржлрж╛ржЗрж▓ ржЗржорзНржкрзЛрж░рзНржЯ рж╣ржУрзЯрж╛рж░ рж╕ржорзЯ тАФ ржХрж┐ржЫрзБ ржХрзЛржб ржПржХржмрж╛рж░ржЗ ржЪрж╛рж▓рж╛рждрзЗ ржкрж╛рж░рзЛ:

```js
// ржЪрзЗржХ ржХрж░рзЗ ржирж┐ржЪрзНржЫрж┐ ржпрзЗржи рж╢рзБржзрзБ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ ржЪрж▓рзБржХ
if (typeof window !== "undefined") {
  checkAuthToken();
  loadDataFromLocalStorage();
}

function App() {
  return <h1>ЁЯМР ржЖржЧрзЗ ржерзЗржХрзЗржЗ ржЗржирж┐рж╢рж┐рзЯрж╛рж▓рж╛ржЗржЬ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ</h1>;
}

function loadDataFromLocalStorage() {
  console.log("ЁЯУж LocalStorage ржерзЗржХрзЗ ржбрзЗржЯрж╛ рж▓рзЛржб рж╣рж▓рзЛ");
}

function checkAuthToken() {
  console.log("ЁЯФР ржЯрзЛржХрзЗржи ржЪрзЗржХ ржХрж░рж╛ рж╣рж▓рзЛ");
}
```

### тЪая╕П рж╕рж╛ржмржзрж╛ржирждрж╛:

ржПржЗ ржкрзНржпрж╛ржЯрж╛рж░рзНржи рж╕ржм ржЬрж╛рзЯржЧрж╛рзЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ рж╕ржорж╕рзНржпрж╛ рж╣рждрзЗ ржкрж╛рж░рзЗред ржХрж╛рж░ржг:

- ржпржЦржиржЗ ржПржЗ ржлрж╛ржЗрж▓ `import` рж╣ржмрзЗ, рждржЦржиржЗ ржХрзЛржб ржЪрж╛рж▓ржмрзЗтАФeven ржпржжрж┐ ржХржорзНржкрзЛржирзЗржирзНржЯ рж░рзЗржирзНржбрж╛рж░ржЗ ржирж╛ рж╣рзЯ!
- ржПрждрзЗ performance ржХржорзЗ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ, ржмрж┐рж╢рзЗрж╖ ржХрж░рзЗ ржмрзЬ ржЕрзНржпрж╛ржкрзЗред

рждрж╛ржЗ ржПржЗ ржкрзНржпрж╛ржЯрж╛рж░рзНржи рж╢рзБржзрзБ `App.js` ржмрж╛ ржЕрзНржпрж╛ржкрзЗрж░ **entry point**-ржП ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛред

---

## ЁЯза ржоржирзЗ рж░рж╛ржЦрж╛рж░ ржмрж┐рж╖рзЯржЧрзБрж▓рзЛ:

| ржмрж┐рж╖рзЯ                                                                                      | ржХрж╛рж░ржг                                            |
| ----------------------------------------------------------------------------------------- | ----------------------------------------------- |
| `useEffect()` ржжрж┐рзЯрзЗ ржПржХржмрж╛рж░ ржЪрж╛рж▓рж╛рждрзЗ ржЪрж╛ржЗрж▓рзЗ `didInit` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ                               | Strict mode-ржП `useEffect()` ржжрзБржЗржмрж╛рж░ ржЪрж▓рзЗ          |
| ржлрж╛ржЗрж▓ ржЗржорзНржкрзЛрж░рзНржЯ рж╣ржУрзЯрж╛рж░ рж╕ржорзЯ ржЪрж╛рж▓рж╛рждрзЗ ржЪрж╛ржЗрж▓рзЗ ржЙржкрж░рзЗ `if (typeof window !== 'undefined')` ржжрж┐рзЯрзЗ ржЪрж╛рж▓рж╛ржУ | ржпрж╛рждрзЗ рж╢рзБржзрзБ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ ржЪрж▓рзЗ, рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржирж╛            |
| ржХрзЛржб рж╕рж╣ржЬ ржУ ржкрж░рж┐рж╖рзНржХрж╛рж░ рж░рж╛ржЦрждрзЗ ржПржЗ рж▓ржЬрж┐ржХ рж╢рзБржзрзБ `App.js` ржмрж╛ main entry point-ржП рж░рж╛ржЦрзЛ                 | ржпрзЗржи ржЕржирзНржп ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ execution ржирж╛ рж╣рзЯ |

---

рждрзБржорж┐ ржЪрж╛ржЗрж▓рзЗ ржЖржорж┐ ржПржЗ ржЕржВрж╢ржЯрж╛ржХрзЗ рж╕рзБржирзНржжрж░ржнрж╛ржмрзЗ PDF-ready ржбрж┐ржЬрж╛ржЗржирзЗ рждрзИрж░рж┐ ржХрж░рзЗ ржжрж┐рждрзЗ ржкрж╛рж░рж┐, ржХрж┐ржВржмрж╛ React Bangla ржмржЗрзЯрзЗрж░ ржЕржзрзНржпрж╛рзЯрзЗ ржпрзБржХрзНржд ржХрж░рзЗ ржжрж┐рждрзЗ ржкрж╛рж░рж┐ред

ржЕржмрж╢рзНржпржЗ, ржирж┐ржЪрзЗ рждрзЛржорж╛рж░ ржжрзЗржУрзЯрж╛ ржЯрзЗржХрзНрж╕ржЯрзЗрж░ **ржмрж╛ржВрж▓рж╛ ржЕржирзБржмрж╛ржж + ржЕрждрж┐рж░рж┐ржХрзНржд ржмрзНржпрж╛ржЦрзНржпрж╛ + ржмрж╛рж╕рзНрждржм ржЬрзАржмржирзЗрж░ ржПржХржЯрж┐ рж╕ржорзНржкрзВрж░рзНржг ржлрж┐ржЪрж╛рж░ ржнрж┐рждрзНрждрж┐ржХ ржЙржжрж╛рж╣рж░ржг** ржжрзЗржУрзЯрж╛ рж╣рж▓рзЛ ржпрзЗржи рждрзБржорж┐ рж╕рж╣ржЬрзЗржЗ ржмрзБржЭрждрзЗ ржкрж╛рж░рзЛред

---

## ЁЯФБ ржмрж┐рж╖рзЯ: **Parent Component ржХрзЗ State Update рж╕ржорзНржкрж░рзНржХрзЗ ржЬрж╛ржирж╛ржирзЛ**

### ЁЯза ржзрж░рзЛ рждрзБржорж┐ ржПржХржЯрж┐ Toggle ржХржорзНржкрзЛржирзЗржирзНржЯ ржмрж╛ржирж╛ржЪрзНржЫрзЛред

ржПржЗ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ `isOn` ржирж╛ржорзЗ ржПржХржЯрж┐ `state` ржЖржЫрзЗ ржпрж╛ `true` ржмрж╛ `false` рж╣рждрзЗ ржкрж╛рж░рзЗред ржЕрж░рзНржерж╛рзО ржЯржЧрж▓ ржЕржи ржЖржЫрзЗ ржирж╛ ржЕржл ржЖржЫрзЗ рж╕рзЗржЯрж╛ ржзрж░рзЗ рж░рж╛ржЦрзЗред
ржПржЗ `Toggle` ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржжрзБржЗржнрж╛ржмрзЗ ржЯржЧрж▓ ржХрж░рж╛ ржпрж╛рзЯ:

1. ржХрзНрж▓рж┐ржХ ржХрж░рзЗ
2. ржбрзНрж░рзНржпрж╛ржЧ ржХрж░рзЗ

рждрзБржорж┐ ржЪрж╛ржУ ржпржЦржиржЗ ржПржЗ `isOn` рж╕рзНржЯрзЗржЯ ржЪрзЗржЮрзНржЬ рж╣ржмрзЗ, рждржЦржи ржпрзЗржи **ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯржХрзЗ ржЬрж╛ржирж╛ржирзЛ рж╣рзЯред** ржПржЬржирзНржп рждрзБржорж┐ `onChange` ржирж╛ржорзЗ ржПржХржЯрж┐ ржлрж╛ржВрж╢ржи ржкрзНржпрж╛рж░рзЗржирзНржЯ ржерзЗржХрзЗ рж░рж┐рж╕рж┐ржн ржХрж░рзЗ, рж╕рзЗржЯрж╛ `useEffect` ржПрж░ ржорж╛ржзрзНржпржорзЗ ржХрж▓ ржХрж░ржЫрзЛред

---

### тЭМ ржнрзБрж▓ ржкржжрзНржзрждрж┐ (ржпрж╛ ржХрж░рж╛ ржЙржЪрж┐ржд ржирж╛)

```jsx
useEffect(() => {
  onChange(isOn);
}, [isOn, onChange]);
```

ржПржЦрж╛ржирзЗ рж╕ржорж╕рзНржпрж╛ рж╣рж▓рзЛ:

- рждрзБржорж┐ ржкрзНрж░ржержорзЗ `setIsOn()` ржжрж┐рзЯрзЗ ржЯржЧрж▓ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржкржбрзЗржЯ ржХрж░ржЫрзЛ
- рждрж╛рж░ржкрж░ React DOM ржЖржкржбрзЗржЯ ржХрж░рзЗ
- рждрж╛рж░ржкрж░ `useEffect` ржЪрж▓ржмрзЗ, рждржЦржи `onChange()` ржХрж▓ рж╣ржмрзЗ
- рждржЦржи ржкрзНржпрж╛рж░рзЗржирзНржЯрзЗрж░ рж╕рзНржЯрзЗржЯ ржЖржмрж╛рж░ ржЖржкржбрзЗржЯ рж╣ржмрзЗ ржПржмржВ ржирждрзБржиржнрж╛ржмрзЗ рж░рзЗржирзНржбрж╛рж░ рж╣ржмрзЗ

ЁЯСЙ **ржлрж▓рзЗ ржжрзБржЗржмрж╛рж░ рж░рзЗржирзНржбрж╛рж░ рж╣рзЯ**, ржпрж╛ ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕рзЗрж░ ржЬржирзНржп ржЦрж╛рж░рж╛ржк ржПржмржВ ржХрзЛржбржУ ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржЬржЯрж┐рж▓ рж╣рзЯрзЗ ржпрж╛рзЯред

---

## тЬЕ рж╕ржарж┐ржХ ржкржжрзНржзрждрж┐: рж╕ржмржХрж┐ржЫрзБ ржПржХржЗ ржЗржнрзЗржирзНржЯ рж╣рзНржпрж╛ржирзНржбрж▓рж╛рж░рзЗ ржХрж░рзЛ

```jsx
function updateToggle(nextIsOn) {
  setIsOn(nextIsOn);
  onChange(nextIsOn);
}
```

ржПржнрж╛ржмрзЗ `setIsOn()` ржЖрж░ `onChange()` ржПржХрж╕рж╛ржерзЗ ржХрж▓ ржХрж░рзЛ ржХрзНрж▓рж┐ржХ ржмрж╛ ржбрзНрж░рзНржпрж╛ржЧ ржЗржнрзЗржирзНржЯрзЗред

---

## тЬЕ ржЖрж░ржУ ржнрж╛рж▓рзЛ ржкржжрзНржзрждрж┐: ржкрзНржпрж╛рж░рзЗржирзНржЯрзЗрж░ ржХрж╛ржЫрзЗ ржкрзБрж░рзЛ рж╕рзНржЯрзЗржЯ рждрзБрж▓рзЗ ржжрж╛ржУ (lifting state up)

```jsx
function Toggle({ isOn, onChange }) {
  function handleClick() {
    onChange(!isOn);
  }

  function handleDragEnd(e) {
    if (isCloserToRightEdge(e)) {
      onChange(true);
    } else {
      onChange(false);
    }
  }
}
```

ржПржЦрж╛ржирзЗ `Toggle` ржХржорзНржкрзЛржирзЗржирзНржЯ ржирж┐ржЬрзЗрж░ ржХрзЛржирзЛ рж╕рзНржЯрзЗржЯ рж░рж╛ржЦрзЗ ржирж╛ред ржкрзБрж░рзЛ рж╕рзНржЯрзЗржЯ **ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯ ржорзЗржЗржиржЯрзЗржЗржи ржХрж░рзЗ**, ржпрж╛ржХрзЗ ржмрж▓рзЗ **"lifting state up"**. ржПрждрзЗ ржЯржЧрж▓ ржХржорзНржкрзЛржирзЗржирзНржЯржЯрж╛ ржкрзБрж░рзЛржкрзБрж░рж┐ ржХржирзНржЯрзНрж░рзЛрж▓ржб рж╣рзЯрзЗ ржпрж╛рзЯред

---

## ЁЯФж ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг: **ржлрзЛржирзЗрж░ ржлрзНрж▓рзНржпрж╛рж╢рж▓рж╛ржЗржЯ ржЕржи/ржЕржл**

### ЁЯФз ржлрж┐ржЪрж╛рж░ рж▓рж┐рж╕рзНржЯ:

1. ржПржХржЯрж┐ `Toggle` ржХржорзНржкрзЛржирзЗржирзНржЯ ржерж╛ржХржмрзЗ (рж╕рзБржЗржЪрзЗрж░ ржорждрзЛ)
2. ржЗржЙржЬрж╛рж░ **ржХрзНрж▓рж┐ржХ ржХрж░рж▓рзЗ** ржлрзНрж▓рзНржпрж╛рж╢рж▓рж╛ржЗржЯ ржЪрж╛рж▓рзБ/ржмржирзНржз рж╣ржмрзЗ
3. ржЗржЙржЬрж╛рж░ **ржбрзНрж░рзНржпрж╛ржЧ ржХрж░рзЗ ржЫрзЗрзЬрзЗ ржжрж┐рж▓рзЗ**, ржмрж╛ржо/ржбрж╛ржи ржжрзЗржЦрзЗ ржлрзНрж▓рзНржпрж╛рж╢рж▓рж╛ржЗржЯ ржЪрж╛рж▓рзБ/ржмржирзНржз рж╣ржмрзЗ
4. ржкрзНржпрж╛рж░рзЗржирзНржЯ ржХржорзНржкрзЛржирзЗржирзНржЯ ржЬрж╛ржиржмрзЗ ржлрзНрж▓рзНржпрж╛рж╢рж▓рж╛ржЗржЯ ржЪрж╛рж▓рзБ ржЖржЫрзЗ ржХрж┐ржирж╛
5. ржпржжрж┐ ржЪрж╛ржУ, `Toggle` ржХржорзНржкрзЛржирзЗржирзНржЯ рж╕рзНржЯрзЗржЯ рж░рж╛ржЦржмрзЗ
6. ржирж╛ ржЪрж╛ржЗрж▓рзЗ рж╕ржм рж╕рзНржЯрзЗржЯ ржкрзНржпрж╛рж░рзЗржирзНржЯрзЗржЗ ржерж╛ржХржмрзЗ

---

### тЬЕ ржХрзЛржб (lifting state up approach):

```jsx
// Toggle.js
function Toggle({ isOn, onChange }) {
  function isCloserToRightEdge(e) {
    return e.clientX > window.innerWidth / 2;
  }

  function handleClick() {
    onChange(!isOn);
  }

  function handleDragEnd(e) {
    if (isCloserToRightEdge(e)) {
      onChange(true);
    } else {
      onChange(false);
    }
  }

  return (
    <div
      draggable
      onClick={handleClick}
      onDragEnd={handleDragEnd}
      className={`w-24 h-12 flex items-center rounded-full 
        ${isOn ? "bg-green-500" : "bg-gray-400"}`}
    >
      <div
        className={`w-10 h-10 rounded-full bg-white shadow-md transition-transform duration-300 
          ${isOn ? "translate-x-6" : "translate-x-0"}`}
      />
    </div>
  );
}
```

```jsx
// App.js (Parent component)
import { useState } from "react";
import Toggle from "./Toggle";

export default function App() {
  const [flashOn, setFlashOn] = useState(false);

  return (
    <div className="min-h-screen flex flex-col items-center justify-center gap-4">
      <Toggle isOn={flashOn} onChange={setFlashOn} />
      <p className="text-xl font-bold">
        Flashlight is {flashOn ? "ON ЁЯФж" : "OFF ЁЯМС"}
      </p>
    </div>
  );
}
```

---

## ЁЯз╛ рж╕рж╛рж░рж╛ржВрж╢:

| ржХрзМрж╢рж▓                                  | рж╕рзБржмрж┐ржзрж╛                                  |
| ------------------------------------- | --------------------------------------- |
| `useEffect` ржжрж┐рзЯрзЗ `onChange` ржХрж▓        | тЭМ ржзрзАрж░, ржжрзБржЯрж┐ рж░рзЗржирзНржбрж╛рж░, ржнрзБрж▓ ржзрж░рждрзЗ ржХржарж┐ржи     |
| ржПржХржЗ ржЗржнрзЗржирзНржЯрзЗ `setState` ржПржмржВ `onChange` | тЬЕ ржжрзНрж░рзБржд, ржПржХржЯрж┐ рж░рзЗржирзНржбрж╛рж░                  |
| lifting state up (stateless child)    | тЬЕ рж╕рж┐ржорзНржкрж▓, рж╕рж┐ржЩрзНржХ рж╕ржорж╕рзНржпрж╛ ржирзЗржЗ, рж░рж┐ржЗржЙржЬржпрзЛржЧрзНржп |

---

<Donate/>
