## рж╕ржорж╕рзНржпрж╛ ржПржмржВ рж╕ржорж╛ржзрж╛ржи: ржпржЦржи ржмрж╛рж░ржмрж╛рж░ рж╕рж╛ржмржорж┐ржЯ ржмрзЛрждрж╛ржорзЗ ржХрзНрж▓рж┐ржХ ржХрж░рж╛ рж╣ржпрж╝, рждржЦржи ржкрзВрж░рзНржмрзЗрж░ ржлрзЗржЪ ржЕржирзБрж░рзЛржз ржмрж┐ржЪрзНржЫрж┐ржирзНржи рж╣ржпрж╝ ржирж╛ ржХрзЗржи? ЁЯдФ

ржЕржирзЗржХ рж╕ржоржпрж╝ ржПржоржи рж╣ржпрж╝ ржпрзЗ ржЖржорж░рж╛ ржХрзЛржирзЛ ржУржпрж╝рзЗржмрж╕рж╛ржЗржЯрзЗ ржХрзЛржирзЛ ржлрж░рзНржо рж╕рж╛ржмржорж┐ржЯ ржХрж░рж╛рж░ ржЬржирзНржп **рж╕рж╛ржмржорж┐ржЯ** ржмрзЛрждрж╛ржорзЗ ржПржХрж╛ржзрж┐ржХржмрж╛рж░ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржлрзЗрж▓рж┐ред ржпржжрж┐ рж╕рж╛рж░рзНржнрж╛рж░ ржерзЗржХрзЗ рж╕рж╛ржбрж╝рж╛ ржЖрж╕рждрзЗ ржжрзЗрж░рж┐ рж╣ржпрж╝, рждрж╛рж╣рж▓рзЗ ржоржирзЗ рж╣рждрзЗ ржкрж╛рж░рзЗ ржкрзНрж░ржержоржмрж╛рж░ ржХрзНрж▓рж┐ржХржЯрж┐ ржХрж╛ржЬ ржХрж░рзЗржирж┐ред ржХрж┐ржирзНрждрзБ ржПрж░ ржлрж▓рзЗ ржЕржирзЗржХ рж╕ржоржпрж╝ ржЕржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд рж╕ржорж╕рзНржпрж╛ ржжрзЗржЦрж╛ ржжрж┐рждрзЗ ржкрж╛рж░рзЗ, ржпрзЗржоржи ржПржХржЗ ржЕржирзБрж░рзЛржз ржПржХрж╛ржзрж┐ржХржмрж╛рж░ ржкрж╛ржарж╛ржирзЛ ржмрж╛ ржкрзВрж░рзНржмрзЗрж░ ржЕржирзБрж░рзЛржз рж╢рзЗрж╖ рж╣ржУржпрж╝рж╛рж░ ржЖржЧрзЗржЗ ржирждрзБржи ржЕржирзБрж░рзЛржз рж╢рзБрж░рзБ рж╣ржУржпрж╝рж╛ред

ржПржЗ ржмрзНрж▓ржЧ ржкрзЛрж╕рзНржЯрзЗ ржЖржорж░рж╛ ржЖрж▓рзЛржЪржирж╛ ржХрж░ржм ржХрзЗржи ржПржоржиржЯрж╛ ржШржЯрзЗ ржПржмржВ ржХрзАржнрж╛ржмрзЗ ржПржЗ рж╕ржорж╕рзНржпрж╛рж░ рж╕ржорж╛ржзрж╛ржи ржХрж░рж╛ ржпрж╛ржпрж╝ред ржЖржорж░рж╛ ржПржХржЯрж┐ React ржХрзЛржб ржЙржжрж╛рж╣рж░ржг ржжрзЗржЦржм ржПржмржВ ржЪрж┐рж╣рзНржирж┐ржд ржХрж░ржм ржХрзЛржерж╛ржпрж╝ рж╕ржорж╕рзНржпрж╛ржЯрж┐ рж╣ржЪрзНржЫрзЗ ржПржмржВ ржХрзАржнрж╛ржмрзЗ рждрж╛ рж╕ржорж╛ржзрж╛ржи ржХрж░рж╛ ржпрж╛ржпрж╝ред

---

### рж╕ржорж╕рзНржпрж╛рж░ ржЙрзОрж╕ ЁЯХ╡я╕ПтАНтЩАя╕П

ржЙржкрж░рзЗ ржжрзЗржУрзЯрж╛ React ржХрзЛржбржЯрж┐рждрзЗ `handleSubmit` ржлрж╛ржВрж╢ржирзЗрж░ ржоржзрзНржпрзЗ ржЫржмрж┐ ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ рж▓рзБржк ржЪрж╛рж▓рж╛ржирзЛ рж╣ржЪрзНржЫрзЗ (рзп ржмрж╛рж░)ред ржкрзНрж░рждрж┐ржЯрж┐ ржЗржЯрж╛рж░рзЗрж╢ржирзЗ ржПржХржЯрж┐ ржирждрзБржи ржлрзЗржЪ ржЕржирзБрж░рзЛржз рж╢рзБрж░рзБ рж╣ржпрж╝ред рж╕ржорж╕рзНржпрж╛ржЯрж╛ рж╣рж▓, ржпржжрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА **рж╕рж╛ржмржорж┐ржЯ** ржмрзЛрждрж╛ржорзЗ ржПржХрж╛ржзрж┐ржХржмрж╛рж░ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ, рждрж╛рж╣рж▓рзЗ `handleSubmit` ржлрж╛ржВрж╢ржиржЯрж┐ рждрждржмрж╛рж░ ржХрж▓ рж╣ржмрзЗ ржПржмржВ рж╕ржорж╛ржирзНрждрж░рж╛рж▓ржнрж╛ржмрзЗ ржПржХрж╛ржзрж┐ржХржмрж╛рж░ рзпржЯрж┐ ржХрж░рзЗ ржлрзЗржЪ ржЕржирзБрж░рзЛржз рж╢рзБрж░рзБ рж╣ржпрж╝рзЗ ржпрж╛ржмрзЗред

ржПржЦрж╛ржирзЗ ржорзВрж▓ рж╕ржорж╕рзНржпрж╛ржЧрзБрж▓рзЛ рж╣рж▓:

1.  **ржкрзВрж░рзНржмрзЗрж░ ржЕржирзБрж░рзЛржз ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ ржирж╛:** ржпржЦржи ржжрзНржмрж┐рждрзАржпрж╝ржмрж╛рж░ рж╕рж╛ржмржорж┐ржЯ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ, рждржЦржи ржкрзНрж░ржержоржмрж╛рж░ рж╢рзБрж░рзБ рж╣ржУржпрж╝рж╛ ржлрзЗржЪ ржЕржирзБрж░рзЛржзржЧрзБрж▓рзЛ рж╕ржорзНржкрж░рзНржХрзЗ ржХрзЛржирзЛ рждржерзНржп рж░рж╛ржЦрж╛ рж╣ржЪрзНржЫрзЗ ржирж╛ред
2.  **ржирждрзБржи ржХрж░рзЗ рж╢рзБрж░рзБ:** ржкрзНрж░рждрж┐ржмрж╛рж░ рж╕рж╛ржмржорж┐ржЯ ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржирждрзБржи ржХрж░рзЗ рзпржЯрж┐ ржлрзЗржЪ ржЕржирзБрж░рзЛржз рж╢рзБрж░рзБ рж╣ржЪрзНржЫрзЗ, ржкрзВрж░рзНржмрзЗрж░ржЧрзБрж▓рзЛ ржмрж╛рждрж┐рж▓ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ ржирж╛ред

ржПрж░ ржлрж▓рзЗ рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржЕрждрж┐рж░рж┐ржХрзНржд ржЪрж╛ржк ржкржбрж╝рждрзЗ ржкрж╛рж░рзЗ ржПржмржВ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЕржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд ржлрж▓рж╛ржлрж▓ ржжрзЗржЦрждрзЗ ржкрж╛рж░рзЗред

---

### рж╕ржорж╛ржзрж╛ржирзЗрж░ ржЙржкрж╛ржпрж╝ ЁЯЫая╕П

ржПржЗ рж╕ржорж╕рзНржпрж╛рж░ рж╕ржорж╛ржзрж╛ржирзЗрж░ ржЬржирзНржп ржЖржорж░рж╛ ржПржХржЯрж┐ **ржлрзНрж▓рзНржпрж╛ржЧ** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐ ржпрж╛ ржирж┐рж░рзНржжрзЗрж╢ ржХрж░ржмрзЗ ржпрзЗ ржмрж░рзНрждржорж╛ржирзЗ ржХрзЛржирзЛ ржлрзЗржЪ ржЕржирзБрж░рзЛржз ржЪрж▓ржЫрзЗ ржХрж┐ржирж╛ред ржпржжрж┐ ржХрзЛржирзЛ ржЕржирзБрж░рзЛржз ржЪрж▓ржорж╛ржи ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ рж╕рж╛ржмржорж┐ржЯ ржмрзЛрждрж╛ржорзЗ ржХрзНрж▓рж┐ржХ ржХрж░рж╛ рж╣рж▓рзЗржУ ржирждрзБржи ржХрж░рзЗ ржХрзЛржирзЛ ржЕржирзБрж░рзЛржз рж╢рзБрж░рзБ рж╣ржмрзЗ ржирж╛ред

ржирж┐ржЪрзЗ рж╕ржВрж╢рзЛржзрж┐ржд ржХрзЛржбржЯрж┐ ржжрзЗржУрзЯрж╛ рж╣рж▓:

import { useEffect, useState } from "react";
import { useImages } from "../../context/ImagesContext";
import getRandomNumber from "../../utils/getRandomNumber";
import AdvancedOptions from "./AdvancedOptions";
import DisplayImages from "./DiplayImages";
import InputPrompt from "./InputPrompt";
import WelcomeMessage from "./WelcomeMessage";

export default function CreatePage() {
┬а const [apiParameters, setApiParameters] = useState({
┬а ┬а promptText: "",
┬а ┬а model: "flux",
┬а ┬а height: "",
┬а ┬а width: "",
┬а });
┬а const [models, setModels] = useState([]);
┬а const [message, setMessage] = useState("");
┬а const { images, setImages } = useImages("");
┬а const [isFetching, setIsFetching] = useState(false); // тЬЕ ржирждрзБржи рж╕рзНржЯрзЗржЯ

// Find models from polination api
┬а useEffect(() =\> {
┬а ┬а let ignore = false;
┬а ┬а async function fetchModel() {
┬а ┬а ┬а try {
┬а ┬а ┬а ┬а const response = await fetch("[https://image.pollinations.ai/models](https://image.pollinations.ai/models)");
┬а ┬а ┬а ┬а if (\!response.ok) {
┬а ┬а ┬а ┬а ┬а console.log("Failted to Fetch Models");
┬а ┬а ┬а ┬а ┬а return;
┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а const data = await response.json();
┬а ┬а ┬а ┬а if (\!ignore) {
┬а ┬а ┬а ┬а ┬а setModels((model) =\> [...model, data]);
┬а ┬а ┬а ┬а }
┬а ┬а ┬а } catch (error) {
┬а ┬а ┬а ┬а console.log(error.message);
┬а ┬а ┬а }
┬а ┬а }
┬а ┬а fetchModel();
┬а ┬а return () =\> (ignore = true);
┬а }, []);

// Function handle prompt submit
┬а async function handleSubmit() {
┬а ┬а if (isFetching) {
┬а ┬а ┬а return; // тЬЕ ржпржжрж┐ ржлрзЗржЪрж┐ржВ ржЪрж▓рждрзЗ ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ ржЖрж░ ржХрж┐ржЫрзБ ржХрж░ржмрзЗ ржирж╛
┬а ┬а }

if (apiParameters?.model == "gptimage") {
┬а ┬а ┬а setMessage(
┬а ┬а ┬а ┬а `This selected Model ${apiParameters?.model}┬а is for Paid User Only`
┬а ┬а ┬а );
┬а ┬а } else {
┬а ┬а ┬а setIsFetching(true); // тЬЕ ржлрзЗржЪрж┐ржВ рж╢рзБрж░рзБ рж╣ржУржпрж╝рж╛рж░ ржЖржЧрзЗ ржлрзНрж▓рзНржпрж╛ржЧ рж╕рзЗржЯ ржХрж░рж╛ рж╣рж▓
┬а ┬а ┬а console.log("fetching start");
┬а ┬а ┬а setImages(() =\>
┬а ┬а ┬а ┬а Array(9)
┬а ┬а ┬а ┬а ┬а .fill(null)
┬а ┬а ┬а ┬а ┬а .map(() =\> ({
┬а ┬а ┬а ┬а ┬а ┬а src: "",
┬а ┬а ┬а ┬а ┬а ┬а seed: 0,
┬а ┬а ┬а ┬а ┬а ┬а loading: "Generating...",
┬а ┬а ┬а ┬а ┬а ┬а error: "",
┬а ┬а ┬а ┬а ┬а }))
┬а ┬а ┬а );
┬а ┬а ┬а for (let i = 0; i \< 9; i++) {
┬а ┬а ┬а ┬а const seed = getRandomNumber();
┬а ┬а ┬а ┬а const url = `https://image.pollinations.ai/prompt/${apiParameters?.promptText}?width=${apiParameters?.width}&height=${apiParameters?.height}&seed=${seed}&model=${apiParameters?.model}`;
┬а ┬а ┬а ┬а const controller = new AbortController();
┬а ┬а ┬а ┬а const timeoutId = setTimeout(() =\> controller.abort(), 16000);

try {
┬а ┬а ┬а ┬а ┬а const response = await fetch(url, {
┬а ┬а ┬а ┬а ┬а ┬а signal: controller.signal, // тЬЕ ржЕржирзБрж░рзЛржз ржмрж╛рждрж┐рж▓ ржХрж░рж╛рж░ ржЬржирзНржп
┬а ┬а ┬а ┬а ┬а });
┬а ┬а ┬а ┬а ┬а if (\!response.ok) {
┬а ┬а ┬а ┬а ┬а ┬а console.log("Fetching data failed");
┬а ┬а ┬а ┬а ┬а ┬а setImages((previous) =\> {
┬а ┬а ┬а ┬а ┬а ┬а ┬а const newImages = [...previous];
┬а ┬а ┬а ┬а ┬а ┬а ┬а newImages [i] = {
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а src: "",
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а seed,
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а loading: "",
┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а error: "Image Generated Fail",
┬а ┬а ┬а ┬а ┬а ┬а ┬а };
┬а ┬а ┬а ┬а ┬а ┬а ┬а return newImages;
┬а ┬а ┬а ┬а ┬а ┬а });
┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а ┬а const data = await response.blob();
┬а ┬а ┬а ┬а ┬а const imageURL = URL.createObjectURL(data);

setImages((previous) =\> {
┬а ┬а ┬а ┬а ┬а ┬а const newImages = [...previous];
┬а ┬а ┬а ┬а ┬а ┬а newImages [i] = { src: imageURL, seed, loading: "", error: "" };
┬а ┬а ┬а ┬а ┬а ┬а return newImages;
┬а ┬а ┬а ┬а ┬а });

// set to images state
┬а ┬а ┬а ┬а } catch (err) {
┬а ┬а ┬а ┬а ┬а setImages((previous) =\> {
┬а ┬а ┬а ┬а ┬а ┬а const newImages = [...previous];
┬а ┬а ┬а ┬а ┬а ┬а newImages [i] = {
┬а ┬а ┬а ┬а ┬а ┬а ┬а src: "",
┬а ┬а ┬а ┬а ┬а ┬а ┬а seed,
┬а ┬а ┬а ┬а ┬а ┬а ┬а loading: "",
┬а ┬а ┬а ┬а ┬а ┬а ┬а error: err.message,
┬а ┬а ┬а ┬а ┬а ┬а };
┬а ┬а ┬а ┬а ┬а ┬а return newImages;
┬а ┬а ┬а ┬а ┬а });
┬а ┬а ┬а ┬а } finally {
┬а ┬а ┬а ┬а ┬а clearTimeout(timeoutId);
┬а ┬а ┬а ┬а ┬а if (i === 8) {
┬а ┬а ┬а ┬а ┬а ┬а setIsFetching(false); // тЬЕ рж╕ржорж╕рзНржд ржлрзЗржЪрж┐ржВ рж╢рзЗрж╖ рж╣рж▓рзЗ ржлрзНрж▓рзНржпрж╛ржЧ рж░рж┐рж╕рзЗржЯ ржХрж░рж╛ рж╣рж▓
┬а ┬а ┬а ┬а ┬а }
┬а ┬а ┬а ┬а }
┬а ┬а ┬а }
┬а ┬а }
┬а }

return (
┬а ┬а \<main className="relative z-10"\>
┬а ┬а ┬а \<WelcomeMessage message=" Let's create a masterpiece, Alvian\!" /\>

\<InputPrompt
┬а ┬а ┬а ┬а onSubmitted={handleSubmit}
┬а ┬а ┬а ┬а apiParameters={apiParameters}
┬а ┬а ┬а ┬а setApiParameters={setApiParameters}
┬а ┬а ┬а /\>
┬а ┬а ┬а {message && \<p className="text-red-500"\>{message}\</p\>}
┬а ┬а ┬а \<AdvancedOptions
┬а ┬а ┬а ┬а models={models}
┬а ┬а ┬а ┬а setApiParameters={setApiParameters}
┬а ┬а ┬а ┬а apiParameters={apiParameters}
┬а ┬а ┬а /\>
┬а ┬а ┬а \<DisplayImages /\>
┬а ┬а \</main\>
┬а );
}

**ржкрж░рж┐ржмрж░рзНрждржиржЧрзБрж▓рзЛ:**

1.  **`isFetching` рж╕рзНржЯрзЗржЯ:** `useState(false)` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ `isFetching` ржирж╛ржорзЗ ржПржХржЯрж┐ ржирждрзБржи рж╕рзНржЯрзЗржЯ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржпрзЛржЧ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред ржПржЯрж┐ ржЯрзНрж░рзНржпрж╛ржХ ржХрж░ржмрзЗ ржмрж░рзНрждржорж╛ржирзЗ ржХрзЛржирзЛ ржлрзЗржЪ ржЕржирзБрж░рзЛржз ржЪрж▓ржЫрзЗ ржХрж┐ржирж╛ред
2.  **`handleSubmit` ржПрж░ рж╢рзБрж░рзБрждрзЗ ржЪрзЗржХ:** `handleSubmit` ржлрж╛ржВрж╢ржирзЗрж░ рж╢рзБрж░рзБрждрзЗ `if (isFetching) { return; }` ржпрзЛржЧ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред ржПрж░ ржорж╛ржирзЗ рж╣рж▓ ржпржжрж┐ `isFetching` ржПрж░ ржорж╛ржи `true` рж╣ржпрж╝ (ржЕрж░рзНржерж╛рзО ржХрзЛржирзЛ ржлрзЗржЪрж┐ржВ ржЪрж▓ржЫрзЗ), рждрж╛рж╣рж▓рзЗ ржлрж╛ржВрж╢ржиржЯрж┐ ржЖрж░ ржХрзЛржирзЛ ржХрж╛ржЬ ржХрж░ржмрзЗ ржирж╛ ржПржмржВ ржлрж┐рж░рзЗ ржпрж╛ржмрзЗред
3.  **ржлрзЗржЪрж┐ржВ рж╢рзБрж░рзБрж░ ржЖржЧрзЗ ржлрзНрж▓рзНржпрж╛ржЧ рж╕рзЗржЯ:** ржпржЦржи ржлрзЗржЪрж┐ржВ рж╢рзБрж░рзБ рж╣ржЪрзНржЫрзЗ (`else` ржмрзНрж▓ржХрзЗрж░ ржнрж┐рждрж░рзЗ), рждржЦржи `setIsFetching(true)` ржХрж▓ ржХрж░рзЗ `isFetching` ржПрж░ ржорж╛ржи `true` ржХрж░рж╛ рж╣ржЪрзНржЫрзЗред
4.  **ржлрзЗржЪрж┐ржВ рж╢рзЗрж╖рзЗ ржлрзНрж▓рзНржпрж╛ржЧ рж░рж┐рж╕рзЗржЯ:** `for` рж▓рзБржкрзЗрж░ `finally` ржмрзНрж▓ржХрзЗрж░ ржнрж┐рждрж░рзЗ ржПржХржЯрж┐ ржХржирзНржбрж┐рж╢ржи ржпрзЛржЧ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ (`if (i === 8)`)ред рж▓рзБржкржЯрж┐ ржпржЦржи рж╢рзЗрж╖ рж╣ржмрзЗ (ржЕрж░рзНржерж╛рзО рзпржЯрж┐ ржЕржирзБрж░рзЛржз рж╕ржорзНржкржирзНржи рж╣ржмрзЗ), рждржЦржи `setIsFetching(false)` ржХрж▓ ржХрж░рзЗ `isFetching` ржПрж░ ржорж╛ржи ржЖржмрж╛рж░ `false` ржХрж░рзЗ ржжрзЗржУрзЯрж╛ рж╣ржЪрзНржЫрзЗред

ржПржЗ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржлрж▓рзЗ, ржпржЦржи ржкрзНрж░ржержоржмрж╛рж░ **рж╕рж╛ржмржорж┐ржЯ** ржмрзЛрждрж╛ржорзЗ ржХрзНрж▓рж┐ржХ ржХрж░рж╛ рж╣ржмрзЗ, рждржЦржи ржлрзЗржЪ ржЕржирзБрж░рзЛржзржЧрзБрж▓рзЛ рж╢рзБрж░рзБ рж╣ржмрзЗ ржПржмржВ `isFetching` ржПрж░ ржорж╛ржи `true` рж╣ржпрж╝рзЗ ржпрж╛ржмрзЗред ржПржЗ рж╕ржоржпрж╝ ржпржжрж┐ ржЖржмрж╛рж░ рж╕рж╛ржмржорж┐ржЯ ржмрзЛрждрж╛ржорзЗ ржХрзНрж▓рж┐ржХ ржХрж░рж╛ рж╣ржпрж╝, рждрж╛рж╣рж▓рзЗ `handleSubmit` ржлрж╛ржВрж╢ржирзЗрж░ рж╢рзБрж░рзБрждрзЗ `isFetching` `true` ржерж╛ржХрж╛рж░ ржХрж╛рж░ржгрзЗ ржирждрзБржи ржХрж░рзЗ ржХрзЛржирзЛ ржЕржирзБрж░рзЛржз рж╢рзБрж░рзБ рж╣ржмрзЗ ржирж╛ред ржпржЦржи ржкрзНрж░ржержо рзпржЯрж┐ ржЕржирзБрж░рзЛржз рж╢рзЗрж╖ рж╣ржмрзЗ, рждржЦржи `isFetching` ржЖржмрж╛рж░ `false` рж╣ржмрзЗ ржПржмржВ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЖржмрж╛рж░ ржирждрзБржи ржХрж░рзЗ ржЕржирзБрж░рзЛржз ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗред

---

### ржЕрждрж┐рж░рж┐ржХрзНржд ржмрж┐ржмрзЗржЪржирж╛ ЁЯТб

- **ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржЕржнрж┐ржЬрзНржЮрждрж╛:** ржпржжрж┐ржУ ржПржЗ рж╕ржорж╛ржзрж╛ржиржЯрж┐ ржПржХрж╛ржзрж┐ржХржмрж╛рж░ рж╕рж╛ржмржорж┐ржЯ ржХрж░рж╛рж░ рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржи ржХрж░рзЗ, рждржмрзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржХрзЗ ржЬрж╛ржирж╛ржирзЛ ржЙржЪрж┐ржд ржпрзЗ рждрж╛ржжрзЗрж░ ржкрзНрж░ржержо ржЕржирзБрж░рзЛржзржЯрж┐ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржзрзАржи рж░ржпрж╝рзЗржЫрзЗред ржПрж░ ржЬржирзНржп ржЖржкржирж┐ ржПржХржЯрж┐ рж▓рзЛржбрж┐ржВ ржЗржирзНржбрж┐ржХрзЗржЯрж░ ржмрж╛ ржмрж╛рж░рзНрждрж╛ ржжрзЗржЦрж╛рждрзЗ ржкрж╛рж░рзЗржи ржпржЦржи `isFetching` ржПрж░ ржорж╛ржи `true` ржерж╛ржХрзЗред
- **ржмрж╛рждрж┐рж▓ ржХрж░рж╛рж░ рж╕рзБржмрж┐ржзрж╛:** ржЖржкржирж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржХрзЗ ржЪрж▓ржорж╛ржи ржлрзЗржЪ ржЕржирзБрж░рзЛржз ржмрж╛рждрж┐рж▓ ржХрж░рж╛рж░ рж╕рзБржпрзЛржЧ ржжрж┐рждрзЗ ржкрж╛рж░рзЗржи ржпржжрж┐ рждрж╛рж░рж╛ ржоржирзЗ ржХрж░рзЗ ржЕржирзЗржХржХрзНрж╖ржг ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рждрзЗ рж╣ржЪрзНржЫрзЗред ржПрж░ ржЬржирзНржп `AbortController` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред

ржЖрж╢рж╛ ржХрж░рж┐ ржПржЗ ржмрзНрж▓ржЧ ржкрзЛрж╕рзНржЯржЯрж┐ ржЖржкржирж╛рж░ ржкрзНрж░рж╢рзНржирзЗрж░ ржЙрждрзНрждрж░ ржжрж┐рждрзЗ ржкрзЗрж░рзЗржЫрзЗ ржПржмржВ ржЖржкржирж┐ ржмрзБржЭрждрзЗ ржкрзЗрж░рзЗржЫрзЗржи ржХрзЗржи ржмрж╛рж░ржмрж╛рж░ рж╕рж╛ржмржорж┐ржЯ ржХрж░рж▓рзЗ ржкрзВрж░рзНржмрзЗрж░ ржЕржирзБрж░рзЛржз ржмрж┐ржЪрзНржЫрж┐ржирзНржи рж╣ржпрж╝ ржирж╛ ржПржмржВ ржХрзАржнрж╛ржмрзЗ ржПржЗ рж╕ржорж╕рзНржпрж╛рж░ рж╕ржорж╛ржзрж╛ржи ржХрж░рж╛ ржпрж╛ржпрж╝ред Happy coding\! ЁЯШК

## Part-2

ржЕржмрж╢рзНржпржЗ! ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржпржЦржи ржлрзЗржЪ ржЕржирзБрж░рзЛржз ржмрж╛рждрж┐рж▓ ржХрж░рзЗ, рждржЦржи ржХрзА ржкржжржХрзНрж╖рзЗржк ржирж┐рждрзЗ рж╣ржмрзЗ, рждрж╛ ржирж┐рзЯрзЗ ржПржХржЯрж┐ ржмрзНрж▓ржЧ ржкрзЛрж╕рзНржЯрзЗрж░ ржжрзНржмрж┐рждрзАрзЯ ржкрж░рзНржм ржирж┐ржЪрзЗ ржжрзЗржУрзЯрж╛ рж╣рж▓рзЛред

---

### ржЗржЙржЬрж╛рж░ ржпржЦржи ржЕржзрзИрж░рзНржп: ржлрзЗржЪ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ ржмрж╛рждрж┐рж▓ ржХрж░рж╛ ржПржмржВ ржкрж░ржмрж░рзНрждрзА ржкржжржХрзНрж╖рзЗржк (ржкрж╛рж░рзНржЯ-рзи)

ржкрзНрж░ржержо ржкрж░рзНржмрзЗ ржЖржорж░рж╛ ржжрзЗржЦрзЗржЫрж┐рж▓рж╛ржо ржХрзАржнрж╛ржмрзЗ ржмрж╛рж░ржмрж╛рж░ рж╕рж╛ржмржорж┐ржЯ ржмрзЛрждрж╛ржорзЗ ржХрзНрж▓рж┐ржХ ржХрж░рж╛ ржерзЗржХрзЗ ржЕрзНржпрж╛ржкржХрзЗ рж░ржХрзНрж╖рж╛ ржХрж░рж╛ ржпрж╛рзЯред ржХрж┐ржирзНрждрзБ ржпржжрж┐ ржлрзЗржЪ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ рж╢рзБрж░рзБ рж╣ржУрзЯрж╛рж░ ржкрж░ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржирж┐ржЬрзЗржЗ ржЕржзрзИрж░рзНржп рж╣рзЯрзЗ ржпрж╛ржи? ржпржжрж┐ ржЫржмрж┐ ржЬрзЗржирж╛рж░рзЗржЯ рж╣рждрзЗ ржЕржирзЗржХ ржмрзЗрж╢рж┐ рж╕ржорзЯ рж▓рж╛ржЧрзЗ ржПржмржВ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржПржЗ ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛ржЯрж┐ ржерж╛ржорж┐рзЯрзЗ ржжрж┐рждрзЗ ржЪрж╛ржи?

ржПржЗ ржкрж░рзНржмрзЗ ржЖржорж░рж╛ ржжрзЗржЦржм ржХрзАржнрж╛ржмрзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржХрзЗ ржПржХржЯрж┐ "Cancel" ржмрж╛ "ржмрж╛рждрж┐рж▓ ржХрж░рзБржи" ржмрзЛрждрж╛ржорзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЪрж▓ржорж╛ржи ржлрзЗржЪ ржЕржирзБрж░рзЛржз ржмрж╛рждрж┐рж▓ ржХрж░рж╛рж░ ржХрзНрж╖ржорждрж╛ ржжрзЗржУрзЯрж╛ ржпрж╛рзЯ ржПржмржВ ржмрж╛рждрж┐рж▓рзЗрж░ ржкрж░ ржЖржорж░рж╛ ржХрзАржнрж╛ржмрзЗ рж╕ржарж┐ржХ ржкржжржХрзНрж╖рзЗржк ржирж┐рждрзЗ ржкрж╛рж░рж┐ред

---

### ржорзВрж▓ рж╣рж╛рждрж┐рзЯрж╛рж░: `AbortController` ЁЯдЦ

ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ ржЪрж▓ржорж╛ржи ржлрзЗржЪ ржЕржирзБрж░рзЛржз ржмрж╛рждрж┐рж▓ ржХрж░рж╛рж░ ржЬржирзНржп рж╕рзНржЯрзНржпрж╛ржирзНржбрж╛рж░рзНржб API рж╣рж▓рзЛ `AbortController`ред ржПржЯрж┐ ржпрзЗржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ:

1.  **рждрзИрж░рж┐ ржХрж░рж╛:** ржкрзНрж░ржержорзЗ ржЖржорж░рж╛ `AbortController`-ржПрж░ ржПржХржЯрж┐ ржЗржирзНрж╕ржЯрзНржпрж╛ржирзНрж╕ рждрзИрж░рж┐ ржХрж░рж┐ред
2.  **рж╕ржВржХрзЗржд (Signal) ржирзЗржУрзЯрж╛:** ржПржЗ ржЗржирзНрж╕ржЯрзНржпрж╛ржирзНрж╕ ржерзЗржХрзЗ ржЖржорж░рж╛ ржПржХржЯрж┐ `signal` ржЕржмржЬрзЗржХрзНржЯ ржкрж╛ржЗред
3.  **`fetch`-ржХрзЗ ржЬрж╛ржирж╛ржирзЛ:** ржПржЗ `signal` ржЕржмржЬрзЗржХрзНржЯржЯрж┐ ржЖржорж░рж╛ `fetch` ржЕржирзБрж░рзЛржзрзЗрж░ ржЕржкрж╢ржи рж╣рж┐рж╕рзЗржмрзЗ ржкрж╛рж╕ ржХрж░рж┐ред
4.  **ржмрж╛рждрж┐рж▓ ржХрж░рж╛:** ржпржЦржи ржЖржорж░рж╛ ржЕржирзБрж░рзЛржзржЯрж┐ ржмрж╛рждрж┐рж▓ ржХрж░рждрзЗ ржЪрж╛ржЗ, рждржЦржи ржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░рзЗрж░ `abort()` ржорзЗржержб ржХрж▓ ржХрж░рж┐ред ржПржЯрж┐ `fetch`-ржХрзЗ ржПржХржЯрж┐ рж╕ржВржХрзЗржд ржкрж╛ржарж╛рзЯ ржПржмржВ `fetch` рждрж╛рж░ ржХрж╛ржЬ ржерж╛ржорж┐рзЯрзЗ ржжрзЗрзЯред

ржЪрж▓рзБржи ржжрзЗржЦрж┐, ржЖржорж╛ржжрзЗрж░ ржЖржЧрзЗрж░ ржХрзЛржбрзЗ ржПржЯрж┐ ржХрзАржнрж╛ржмрзЗ ржпрзБржХрзНржд ржХрж░рж╛ ржпрж╛рзЯред

---

### рж╕ржорж╕рзНржпрж╛рж░ рж╕ржорж╛ржзрж╛ржи: ржХрзЛржбрзЗ ржкрж░рж┐ржмрж░рзНрждржи ЁЯСитАНЁЯТ╗

ржЖржорж░рж╛ ржЖржорж╛ржжрзЗрж░ `CreatePage` ржХржорзНржкрзЛржирзЗржирзНржЯрзЗ ржПржХржЯрж┐ "Cancel" ржмрж╛ржЯржи ржпрзЛржЧ ржХрж░ржм ржПржмржВ `AbortController` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржлрзЗржЪ ржмрж╛рждрж┐рж▓рзЗрж░ ржХрж╛рж░рзНржпржХрж╛рж░рж┐рждрж╛ ржпрзБржХрзНржд ржХрж░ржмред

#### ржзрж╛ржк рзз: `AbortController`-ржХрзЗ ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рж╛

ржЖржорж╛ржжрзЗрж░ `AbortController`-ржПрж░ ржЗржирзНрж╕ржЯрзНржпрж╛ржирзНрж╕ржХрзЗ ржХржорзНржкрзЛржирзЗржирзНржЯрзЗрж░ ржоржзрзНржпрзЗ ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рждрзЗ рж╣ржмрзЗ ржпрж╛рждрзЗ ржЖржорж░рж╛ ржпрзЗржХрзЛржирзЛ рж╕ржорзЯ ржПржЯрж┐ржХрзЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рждрзЗ ржкрж╛рж░рж┐ред ржПрж░ ржЬржирзНржп `useRef` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╕ржмржЪрзЗрзЯрзЗ ржнрж╛рж▓рзЛ ржЙржкрж╛рзЯ, ржХрж╛рж░ржг ржПржЯрж┐ рж░рж┐-рж░рзЗржирзНржбрж╛рж░ ржЫрж╛рзЬрж╛ржЗ ржорж╛ржи ржзрж░рзЗ рж░рж╛ржЦрждрзЗ ржкрж╛рж░рзЗред

```javascript
import { useEffect, useState, useRef } from "react"; // тЬЕ useRef ржЗржоржкрзЛрж░рзНржЯ ржХрж░рзБржи
// ... ржмрж╛ржХрж┐ ржХрзЛржб

export default function CreatePage() {
  // ... ржЕржирзНржпрж╛ржирзНржп рж╕рзНржЯрзЗржЯ
  const [isFetching, setIsFetching] = useState(false);
  const abortControllerRef = useRef(null); // тЬЕ AbortController ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рж╛рж░ ржЬржирзНржп ref

  // ... ржмрж╛ржХрж┐ ржХрзЛржб
}
```

#### ржзрж╛ржк рзи: ржлрзЗржЪ ржмрж╛рждрж┐рж▓рзЗрж░ ржкрж░ ржкржжржХрзНрж╖рзЗржк ржирзЗржУрзЯрж╛

ржпржЦржи `fetch` ржЕржирзБрж░рзЛржз `abort()` ржорзЗржержбрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржмрж╛рждрж┐рж▓ ржХрж░рж╛ рж╣рзЯ, рждржЦржи ржПржЯрж┐ ржПржХржЯрж┐ `Promise rejection` ржжрзЗрзЯ ржПржмржВ `catch` ржмрзНрж▓ржХрзЗ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржирж╛ржорзЗрж░ (`AbortError`) ржПрж░рж░ ржерзНрж░рзЛ ржХрж░рзЗред ржЖржорж░рж╛ ржПржЗ ржПрж░рж░ржЯрж┐ ржзрж░рзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржХрзЗ ржЬрж╛ржирж╛рждрзЗ ржкрж╛рж░рж┐ ржпрзЗ ржЕржирзБрж░рзЛржзржЯрж┐ рж╕ржлрж▓ржнрж╛ржмрзЗ ржмрж╛рждрж┐рж▓ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред

#### рж╕ржВрж╢рзЛржзрж┐ржд ржХрзЛржб:

ржирж┐ржЪрзЗ рж╕ржорзНржкрзВрж░рзНржг рж╕ржВрж╢рзЛржзрж┐ржд ржХрзЛржб ржжрзЗржУрзЯрж╛ рж╣рж▓рзЛ, ржпрзЗржЦрж╛ржирзЗ ржлрзЗржЪ ржмрж╛рждрж┐рж▓рзЗрж░ ржХрж╛рж░рзНржпржХрж╛рж░рж┐рждрж╛ ржпрзБржХрзНржд ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред

```javascript
import { useEffect, useState, useRef } from "react";
import { useImages } from "../../context/ImagesContext";
import getRandomNumber from "../../utils/getRandomNumber";
import AdvancedOptions from "./AdvancedOptions";
import DisplayImages from "./DiplayImages";
import InputPrompt from "./InputPrompt";
import WelcomeMessage from "./WelcomeMessage";

export default function CreatePage() {
  const [apiParameters, setApiParameters] = useState({
    promptText: "",
    model: "flux",
    height: "",
    width: "",
  });
  const [models, setModels] = useState([]);
  const [message, setMessage] = useState("");
  const { images, setImages } = useImages("");
  const [isFetching, setIsFetching] = useState(false);
  const abortControllerRef = useRef(null); // тЬЕ AbortController ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рж╛рж░ ржЬржирзНржп ref

  // ... ржоржбрзЗрж▓ ржлрзЗржЪ ржХрж░рж╛рж░ useEffect (ржЕржкрж░рж┐ржмрж░рзНрждрж┐ржд)

  // тЬЕ ржлрзЗржЪ ржмрж╛рждрж┐рж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржлрж╛ржВрж╢ржи
  function handleCancel() {
    if (abortControllerRef.current) {
      abortControllerRef.current.abort();
      setIsFetching(false);
      console.log("Fetch requests cancelled by the user.");
    }
  }

  async function handleSubmit() {
    if (isFetching) {
      return;
    }

    if (apiParameters?.model === "gptimage") {
      setMessage(
        `This selected Model ${apiParameters?.model} is for Paid User Only`
      );
    } else {
      setIsFetching(true);
      abortControllerRef.current = new AbortController(); // тЬЕ ржкрзНрж░рждрж┐ржЯрж┐ рж╕рж╛ржмржорж┐ржЯрзЗ ржирждрзБржи ржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░

      console.log("fetching start");
      setImages(() =>
        Array(9)
          .fill(null)
          .map(() => ({
            src: "",
            seed: 0,
            loading: "Generating...",
            error: "",
          }))
      );

      for (let i = 0; i < 9; i++) {
        const seed = getRandomNumber();
        const url = `https://image.pollinations.ai/prompt/${apiParameters?.promptText}?width=${apiParameters?.width}&height=${apiParameters?.height}&seed=${seed}&model=${apiParameters?.model}`;

        try {
          const response = await fetch(url, {
            signal: abortControllerRef.current.signal, // тЬЕ рж╕рж┐ржЧржирзНржпрж╛рж▓ ржкрж╛рж╕ ржХрж░рж╛
          });

          if (!response.ok) {
            // ... ржПрж░рж░ рж╣рзНржпрж╛ржирзНржбрж▓рж┐ржВ (ржЕржкрж░рж┐ржмрж░рзНрждрж┐ржд)
          }

          const data = await response.blob();
          const imageURL = URL.createObjectURL(data);

          setImages((previous) => {
            const newImages = [...previous];
            newImages[i] = { src: imageURL, seed, loading: "", error: "" };
            return newImages;
          });
        } catch (err) {
          // тЬЕ ржмрж╛рждрж┐рж▓ ржХрж░рж╛ рж╣рж▓рзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржкржжржХрзНрж╖рзЗржк
          if (err.name === "AbortError") {
            setImages((previous) => {
              const newImages = [...previous];
              // ржпрзЗрж╕ржм ржЫржмрж┐ рж▓рзЛржб рж╣ржЪрзНржЫрж┐рж▓, рж╕рзЗржЧрзБрж▓рзЛржХрзЗ ржмрж╛рждрж┐рж▓ рж╣рж┐рж╕рзЗржмрзЗ ржжрзЗржЦрж╛ржирзЛ
              for (let j = i; j < 9; j++) {
                if (newImages[j].loading) {
                  newImages[j] = {
                    src: "",
                    seed: 0,
                    loading: "",
                    error: "ржЕржирзБрж░рзЛржз ржмрж╛рждрж┐рж▓ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ",
                  };
                }
              }
              return newImages;
            });
            break; // тЬЕ ржмрж╛рждрж┐рж▓ рж╣рж▓рзЗ рж▓рзБржк ржерзЗржХрзЗ ржмрзЗрж░рж┐рзЯрзЗ ржЖрж╕рж╛
          } else {
            // ... ржЕржирзНржпрж╛ржирзНржп ржПрж░рж░ рж╣рзНржпрж╛ржирзНржбрж▓рж┐ржВ (ржЕржкрж░рж┐ржмрж░рзНрждрж┐ржд)
          }
        } finally {
          if (i === 8) {
            setIsFetching(false);
          }
        }
      }
    }
  }

  return (
    <main className="relative z-10">
      <WelcomeMessage message=" Let's create a masterpiece, Alvian!" />

      <InputPrompt
        onSubmitted={handleSubmit}
        apiParameters={apiParameters}
        setApiParameters={setApiParameters}
      />

      {/* тЬЕ ржлрзЗржЪрж┐ржВ ржЪрж▓рж╛ржХрж╛рж▓рзАржи ржмрж╛рждрж┐рж▓ ржмрж╛ржЯржи ржжрзЗржЦрж╛ржирзЛ */}
      {isFetching && (
        <button
          onClick={handleCancel}
          className="mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
        >
          ржмрж╛рждрж┐рж▓ ржХрж░рзБржи
        </button>
      )}

      {message && <p className="text-red-500">{message}</p>}
      <AdvancedOptions
        models={models}
        setApiParameters={setApiParameters}
        apiParameters={apiParameters}
      />
      <DisplayImages />
    </main>
  );
}
```

#### ржкрж░рж┐ржмрж░рзНрждржиржЧрзБрж▓рзЛрж░ ржмрзНржпрж╛ржЦрзНржпрж╛:

1.  **`handleCancel` ржлрж╛ржВрж╢ржи:** ржПржЗ ржлрж╛ржВрж╢ржиржЯрж┐ `abortControllerRef`-ржП ржерж╛ржХрж╛ ржмрж░рзНрждржорж╛ржи ржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░рзЗрж░ `abort()` ржорзЗржержбржХрзЗ ржХрж▓ ржХрж░рзЗред ржПрж░ ржлрж▓рзЗ `fetch` ржЕржирзБрж░рзЛржзржЯрж┐ ржмрж╛рждрж┐рж▓ рж╣рзЯрзЗ ржпрж╛рзЯред
2.  **`handleSubmit`-ржП ржкрж░рж┐ржмрж░рзНрждржи:**
    - ржкрзНрж░рждрж┐ржмрж╛рж░ ржирждрзБржи рж╕рж╛ржмржорж┐ржЯ ржХрж░рж╛рж░ рж╕ржорзЯ `new AbortController()` ржжрж┐рзЯрзЗ ржПржХржЯрж┐ ржирждрзБржи ржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░ рждрзИрж░рж┐ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗред
    - `fetch`-ржПрж░ ржЕржкрж╢ржирзЗ `{ signal: abortControllerRef.current.signal }` ржкрж╛рж╕ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗред
3.  **`catch` ржмрзНрж▓ржХрзЗ ржкрж░рж┐ржмрж░рзНрждржи:**
    - `err.name === 'AbortError'` ржЪрзЗржХ ржХрж░рзЗ ржЖржорж░рж╛ ржирж┐рж╢рзНржЪрж┐ржд рж╣ржЪрзНржЫрж┐ ржпрзЗ ржПрж░рж░ржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржмрж╛рждрж┐рж▓рзЗрж░ ржХрж╛рж░ржгрзЗржЗ ржШржЯрзЗржЫрзЗред
    - ржпржжрж┐ ржЕржирзБрж░рзЛржз ржмрж╛рждрж┐рж▓ рж╣рзЯ, рждрж╛рж╣рж▓рзЗ ржЖржорж░рж╛ UI-рждрзЗ ржПржХржЯрж┐ ржмрж╛рж░рзНрждрж╛ ("ржЕржирзБрж░рзЛржз ржмрж╛рждрж┐рж▓ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ") ржжрзЗржЦрж╛ржЪрзНржЫрж┐ ржПржмржВ `break` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ `for` рж▓рзБржкржЯрж┐ ржерж╛ржорж┐рзЯрзЗ ржжрж┐ржЪрзНржЫрж┐ ржпрж╛рждрзЗ ржЖрж░ ржХрзЛржирзЛ ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржЕржирзБрж░рзЛржз ржирж╛ ржпрж╛рзЯред
4.  **UI-рждрзЗ ржмрж╛рждрж┐рж▓ ржмрж╛ржЯржи:**
    - JSX-ржПрж░ ржоржзрзНржпрзЗ `isFetching` `true` ржерж╛ржХрж╛ ржЕржмрж╕рзНржерж╛рзЯ ржПржХржЯрж┐ "ржмрж╛рждрж┐рж▓ ржХрж░рзБржи" ржмрж╛ржЯржи ржжрзЗржЦрж╛ржирзЛ рж╣ржЪрзНржЫрзЗред ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржПржЗ ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рж▓рзЗ `handleCancel` ржлрж╛ржВрж╢ржиржЯрж┐ ржХрж▓ рж╣ржмрзЗред

---

### рж╢рзЗрж╖ ржХржерж╛

ржПржЗ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЖржорж░рж╛ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржХрзЗ ржЖрж░ржУ ржмрзЗрж╢рж┐ ржирж┐рзЯржирзНрждрзНрж░ржг ржжрж┐рзЯрзЗржЫрж┐ред ржПржЦржи рждрж╛рж░рж╛ рж╢рзБржзрзБ ржПржХрж╛ржзрж┐ржХржмрж╛рж░ рж╕рж╛ржмржорж┐ржЯ ржХрж░рж╛ ржерзЗржХрзЗржЗ ржмрж┐рж░ржд ржерж╛ржХржмрзЗ ржирж╛, ржмрж░ржВ ржЪрж▓ржорж╛ржи ржХрзЛржирзЛ ржжрзАрж░рзНржШ ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛ржХрзЗ ржирж┐ржЬрзЗрж░ ржЗржЪрзНржЫрж╛ржорждрзЛ ржерж╛ржорж┐рзЯрзЗржУ ржжрж┐рждрзЗ ржкрж╛рж░ржмрзЗред ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржЕржнрж┐ржЬрзНржЮрждрж╛ржХрзЗ (User Experience) ржЖрж░ржУ ржЙржирзНржиржд ржХрж░рзЗ ржПржмржВ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржиржХрзЗ ржЖрж░ржУ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржУ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА-ржмрж╛ржирзНржзржм ржХрж░рзЗ рждрзЛрж▓рзЗред

Happy Coding! ЁЯЪА

## Part 3

Md. Mojnu Miah ржнрж╛ржЗ, ржЖржкржирж┐ ржЦрзБржм ржнрж╛рж▓рзЛ ржкрзНрж░рж╢рзНржи ржХрж░рзЗржЫрзЗржи!
ржпржжрж┐ ржЖржкржирж┐ `for loop` ржжрж┐рзЯрзЗ рзп ржмрж╛рж░ image fetch ржХрж░рзЗржи (ржпрзЗржоржи ржЖржкржирж╛рж░ ржЖржЧрзЗрж░ ржХрзЛржбрзЗ), ржПржмржВ ржЗржЙржЬрж╛рж░ ржЪрж╛рзЯ **fetch ржЪрж╛рж▓рж╛ржХрж╛рж▓рзАржи ржпрзЗржХрзЛржирзЛ рж╕ржорзЯ Cancel** ржХрж░рждрзЗтАФрждрж╛рж╣рж▓рзЗ ржЖржкржирж╛ржХрзЗ **AbortController**, `useRef`, ржПржмржВ `cancel` ржмрж╛ржЯржирзЗрж░ ржорж╛ржзрзНржпржорзЗ **request cancel logic** ржмрж╛ржирж╛рждрзЗ рж╣ржмрзЗред

---

## тЬЕ рж▓ржХрзНрж╖тАМрзНржп:

- ржЗржЙржЬрж╛рж░ Submit ржХрзНрж▓рж┐ржХ ржХрж░рж▓рзЗ рзпржЯрж┐ request ржкрж╛ржарж╛ржирзЛ рж╣ржмрзЗред
- ржЗржЙржЬрж╛рж░ Cancel ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рж▓рзЗ рждржЦржиржЗ **ржмрж╛ржХрж┐ рж╕ржм fetch ржмржирзНржз рж╣рзЯрзЗ ржпрж╛ржмрзЗ**ред

---

## ЁЯза ржкрж░рж┐ржХрж▓рзНржкржирж╛:

1. тЬЕ `controllersRef` тАУ рж╕ржм AbortController рж░рж╛ржЦрж╛рж░ ржЬржирзНржпред
2. тЬЕ `isCancelled` тАУ ржЗржЙржЬрж╛рж░ cancel ржХрж░рж▓рзЛ ржХрж┐ржирж╛ рж╕рзЗржЯрж╛ ржЯрзНрж░тАНрзНржпрж╛ржХ ржХрж░рждрзЗред
3. тЬЕ ржПржХржЯрж┐ Cancel Button ржпрзЛржЧ ржХрж░ржмрзЛред
4. тЬЕ fetch ржПрж░ ржорж╛ржЭрзЗржЗ ржЪрзЗржХ ржХрж░ржмрзЛ ржЗржЙржЬрж╛рж░ cancel ржХрж░рж▓рзЛ ржХрж┐ржирж╛ред

---

## тЬЕ ржЪрзВрзЬрж╛ржирзНржд ржЙржжрж╛рж╣рж░ржг (React + Tailwind friendly)

```jsx
import { useRef, useState } from "react";
import getRandomNumber from "./getRandomNumber";

export default function ImageFetcher() {
  const [images, setImages] = useState([]);
  const [isFetching, setIsFetching] = useState(false);
  const controllersRef = useRef([]);
  const isCancelledRef = useRef(false);

  const handleSubmit = async () => {
    // Reset cancel state and abort old requests
    isCancelledRef.current = false;
    controllersRef.current.forEach((controller) => controller.abort());
    controllersRef.current = [];

    setIsFetching(true);
    setImages(Array(9).fill({ loading: true }));

    for (let i = 0; i < 9; i++) {
      if (isCancelledRef.current) {
        console.log("User cancelled, stopping remaining requests");
        break;
      }

      const seed = getRandomNumber();
      const controller = new AbortController();
      controllersRef.current.push(controller);

      const url = `https://image.pollinations.ai/prompt/football?width=256&height=256&seed=${seed}&model=flux`;

      try {
        const response = await fetch(url, {
          signal: controller.signal,
        });

        if (!response.ok) throw new Error("Fetch failed");

        const blob = await response.blob();
        const imageUrl = URL.createObjectURL(blob);

        setImages((prev) => {
          const copy = [...prev];
          copy[i] = { src: imageUrl, loading: false };
          return copy;
        });
      } catch (err) {
        setImages((prev) => {
          const copy = [...prev];
          copy[i] = { error: err.message, loading: false };
          return copy;
        });
      }
    }

    setIsFetching(false);
  };

  const handleCancel = () => {
    console.log("Cancelling...");
    isCancelledRef.current = true;
    controllersRef.current.forEach((controller) => controller.abort());
    controllersRef.current = [];
    setIsFetching(false);
  };

  return (
    <div className="p-4">
      <div className="space-x-4 mb-4">
        <button
          onClick={handleSubmit}
          disabled={isFetching}
          className="bg-blue-500 text-white px-4 py-2 rounded"
        >
          {isFetching ? "Generating..." : "Generate Images"}
        </button>

        {isFetching && (
          <button
            onClick={handleCancel}
            className="bg-red-500 text-white px-4 py-2 rounded"
          >
            Cancel
          </button>
        )}
      </div>

      <div className="grid grid-cols-3 gap-4">
        {images.map((img, idx) => (
          <div
            key={idx}
            className="h-40 w-40 border flex items-center justify-center text-xs text-gray-500"
          >
            {img.loading ? (
              "Loading..."
            ) : img.src ? (
              <img src={img.src} className="object-cover h-full w-full" />
            ) : (
              img.error || "Error"
            )}
          </div>
        ))}
      </div>
    </div>
  );
}
```

---

## тЬЕ ржЖржкржирж┐ ржпрж╛ ржкрж╛ржмрзЗржи:

- Submit тЖТ рзпржЯрж╛ ржЫржмрж┐ рж▓рзЛржб рж╣ржмрзЗред
- Cancel тЖТ рж╕ржЩрзНржЧрзЗ рж╕ржЩрзНржЧрзЗ рж╕ржм ржмржирзНржз рж╣рзЯрзЗ ржпрж╛ржмрзЗред
- ржЗржЙржЬрж╛рж░ ржПржХрж╛ржзрж┐ржХржмрж╛рж░ Submit ржХрзНрж▓рж┐ржХ ржХрж░рж▓рзЗ ржЖржЧрзЗрж░ fetch ржмрж╛рждрж┐рж▓ рж╣ржмрзЗред

---

## ЁЯФД ржкрж░ржмрж░рзНрждрзА ржкржжржХрзНрж╖рзЗржк:

- ржЪрж╛ржЗрж▓рзЗ Cancel button ржП "Cancel & Reset" ржмрж╛ UI Reset ржЕржкрж╢ржиржУ ржпрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред
- рж▓рзЛржбрж┐ржВ рж╕рзНржкрж┐ржирж╛рж░/ржкрзНрж░рзЛржЧрзНрж░рзЗрж╕ ржмрж╛рж░ ржпрзЛржЧ ржХрж░рждрзЗ ржЪрж╛ржи?

ржмрж▓рж▓рзЗ ржЖржорж┐ рж╕рзЗржЯрж╛ рж╕рж╣ ржХрзЛржб ржЖржкржбрзЗржЯ ржХрж░рзЗ ржжрж┐ржЗред

---

ржЖржкржирж┐ ржХрж┐ ржПржЗ Cancel ржлрж┐ржЪрж╛рж░ `CreatePage` ржП integrate ржХрж░рждрзЗ ржЪрж╛ржи? ржЖржорж┐ рж╕рзЗржЯрж╛ржУ ржХрж░рзЗ ржжрж┐рждрзЗ ржкрж╛рж░рж┐тАФstep by stepред
